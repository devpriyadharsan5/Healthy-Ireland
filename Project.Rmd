---
title: "Exploring the Relationship between Smoking, Alcohol Consumption, and Demographic Factors: A Survey-Based Analysis"

author: "Devpriyadharsan Balan Saravanan - 22250355"

output:
  pdf_document: default
  html_document: default
---

```{r,echo = FALSE, warning=FALSE,message=FALSE}
suppressWarnings(library(caret))
suppressWarnings(library(dplyr))
suppressWarnings(library(e1071))
suppressWarnings(library(foreign))
suppressWarnings(library(GGally)) 
suppressWarnings(library(ggplot2))
suppressWarnings(library(haven))
suppressWarnings(library(here))
suppressWarnings(library(knitr))
suppressWarnings(library(labelled))
suppressWarnings(library(magrittr))
suppressWarnings(library(naivebayes))
suppressWarnings(library(performance))
suppressWarnings(library(plyr))
suppressWarnings(library(pROC))
suppressWarnings(library(psych)) 
suppressWarnings(library(sf))
suppressWarnings(library(tibble))
suppressWarnings(library(tidyverse))
suppressWarnings(library(xgboost))
```



```{r,echo = FALSE, warning=FALSE,message=FALSE}

# Read the data from the SPSS file
data <- read_sav("0021-04_healthy_ireland_2018.sav")
```


```{r,echo = FALSE, warning=FALSE,message=FALSE}

# Select columns "q6", "q7", "q8", "slq9b", "q10", "q11", "q13", "q340", "q348", "q349" from the original data frame and assign it to df1.
df1 <- data[c("q6", "q7", "q8", "slq9b", "q10", "q11", "q13", "q340", "q348", "q349")]


# Select columns "q14", "exq15", "exq18" from the original data frame and assign it to df2.
df2 <- data[c("q14", "exq15", "exq18")]


# Select columns "spq1", "q52", "q55", "q58", "q120", "q205", "q208", "q308" from the original data frame and assign it to df3.
df3 <- data[c("spq1", "q52", "q55", "q58", "q120", "q205", "q208", "q308")]


# Select columns "q229", "q230", "q231", "q232", "q233", "q330_1", "q330_2", "q330_3" from the original data frame and assign it to df4.
df4 <- data[c("q229", "q230", "q231", "q232", "q233", "q330_1", "q330_2", "q330_3")]


# Select columns "q63b", "lho", "key1", "ageclass", "countbirth" from the original data frame and assign it to df5.
df5 <- data[c("q63b", "lho", "key1", "ageclass", "countbirth")]

```


```{r,echo = FALSE, warning=FALSE,message=FALSE}

#combines the previously created data frames
newdata <- cbind(df1, df2,df3,df4,df5) 

# Write the 'newdata' data frame to an SPSS SAV file named "newdata.sav"
#write_sav(newdata, "newdata.sav") 
```


```{r,echo = FALSE, warning=FALSE,message=FALSE}
#val_labels(df2) #gives options
```


```{r,echo = FALSE, warning=FALSE,message=FALSE}
#var_label(df2) #gives questions
```



```{r,echo = FALSE, warning=FALSE,message=FALSE}

#converting to factors

n1<- to_factor((newdata), drop_unused_labels=TRUE, ordered=TRUE) #always use n1
```


```{r,echo = FALSE, warning=FALSE,message=FALSE}
#table(n1$q6,exclude = NULL)
```



###  1. What percentage of the population smokes and how does this vary by age?

```{r, echo = FALSE, warning=FALSE,message=FALSE}

# Re-code smoking variable to combine "Yes, daily" and "Yes, occasionally"
n1$q6 <- ifelse(n1$q6 %in% c("Yes, daily", "Yes, occasionally"), "Yes", "No")


s1 <- n1 %>% 
  dplyr::group_by(q6, ageclass) %>%  # Group the data by smoking status (q6) and age group (ageclass)
  dplyr::summarise(count = n()) |>
  drop_na() |>
  ungroup() %>%
  group_by(ageclass) %>%
  dplyr::mutate(perc = count/sum(count)*100) %>%  # Calculate the percentage within each age group
  dplyr::select(ageclass, q6, count)  # Select only the relevant columns for further analysis



# Calculate the percentage of individuals in each group 
smoking_by_age <- 
  s1 %>% 
  group_by(ageclass, q6) %>%  # Group the data by age group and smoking status
  dplyr::summarise(count = sum(count)) %>%  # Summarize the count of observations within each group
  ungroup() %>% 
  group_by(ageclass) %>%  # Group the data only by age group
  dplyr::summarise(perc = count*100/sum(count),  # Calculate the percentage within each age group
                   q6 = q6) %>%  # Keep the smoking status variable for plotting purposes
  arrange(ageclass)  # Arrange the data by age group in ascending order



# Plot the results
ggplot(smoking_by_age, aes(x = ageclass, y = perc, fill = q6)) +
  geom_bar(stat = "identity")+
  labs(x = "Age", y = "Percentage of population", fill = "Smoking status") +
  scale_fill_discrete(name = "Do you Smoke?") +
  ggtitle("Smoking by Age") +
  theme(plot.title = element_text(hjust = 0.5))

```

This output provides insights into the prevalence of smoking among different age groups. 

* For the age group **15-24 years**, the percentage of non-smokers is approximately 80.06% and the percentage of smokers is 19.94%.

* For the age group **25-44 years**, the percentage of non-smokers is approximately 76.17% and the percentage of smokers is 23.83%.

* For the age group **45-64 years**, the percentage of non-smokers is approximately 80.58% and the percentage of smokers is 19.42%.

* For the age group **65 and over**, the percentage of non-smokers is approximately 89.44% and the percentage of smokers is 10.56%.


The highest percentage of smokers is observed in the age group "25-44 years" with approximately 23.83% of individuals being smokers. This age group has a higher smoking prevalence compared to other age groups.

The age group "65 and over" has the lowest smoking prevalence, with only approximately 10.56% of individuals being smokers. This age group has the lowest percentage of smokers among all the age groups analyzed.

The age groups "15-24 years" and "45-64 years" show relatively similar smoking prevalence, with approximately 19.94% and 19.42% of individuals being smokers, respectively.


Overall, the analysis indicates that smoking prevalence varies across different age groups. These findings highlight the importance of targeted smoking prevention and cessation efforts, particularly among the younger age groups where smoking rates are relatively higher.



**Calculating relative risk and an odds ratio for 25-44 year olds compared to 65 +**

* relative risk = 0.2383/0.1056 = 2.25

* odds for 25-44 = 0.2383/(1-0.2383) = 0.31

* odds for 65+ = 0.1056/(1-0.1056) = 0.12

* odds ratio = 0.31/0.12 = 2.58


The relative risk compares the risk of smoking between the two age groups. A relative risk of 2.25 means that individuals in the 25-44 age group have a 2.25 times higher risk of smoking compared to individuals aged 65 and above. This indicates that the younger age group has a significantly higher likelihood of being smokers compared to the older age group.


The odds ratio compares the odds of smoking between the two age groups. An odds ratio of 2.58 means that the odds of smoking in the 25-44 age group are 2.58 times higher than the odds of smoking in the 65+ age group. This suggests that individuals in the younger age group are more likely to smoke than individuals in the older age group.



This finding highlights the importance of targeted interventions and prevention efforts to reduce smoking prevalence among younger individuals. It suggests that specific strategies and policies should be implemented to address the higher smoking rates observed in the 25-44 age group. These measures could include education, awareness campaigns, smoking cessation programs, and policies aimed at reducing tobacco accessibility and promoting healthier behaviors.





#### Chi-squared test
```{r,echo = FALSE, warning=FALSE,message=FALSE}

q1 <- n1 %>%
  dplyr::select(q6, ageclass) |>  # Select the variables of interest
  table()  # Create a contingency table

chisq.test(q1)  # Perform the chi-squared test

```



### 2. What percentage of the population smokes and how does this vary by gender?

```{r, echo = FALSE, warning=FALSE,message=FALSE}

s2 <- n1 %>%
  dplyr::group_by(q6, q52) %>%
  dplyr::summarise(count = n()) |>  # Count the number of individuals in each smoking status and gender combination
  drop_na() |>  # Drop rows with missing values
  ungroup() %>%
  group_by(q52) %>%
  dplyr::mutate(perc = count/sum(count)*100) |>  # Calculate the percentage of individuals in each group
  dplyr::select(q52, q6, count)  # Select relevant columns



# Calculate the percentage of smokers and non-smokers for each gender
smoking_by_gender <- 
  s2 %>%
  group_by(q52, q6) %>% # Group the data by 'q52' (gender) and 'q6' (smoking status)
  dplyr::summarise(count = sum(count)) %>%
  ungroup() %>%
  group_by(q52) %>%
  dplyr::summarise(perc = count*100/sum(count),
                   q6 = q6) %>%
  arrange(q52)

# Plot the results
ggplot(smoking_by_gender, aes(x = q52, y = perc, fill = q6)) +
  geom_bar(stat = "identity") +
  labs(x = "Gender", y = "Percentage", fill = "Smoking") +
  ggtitle("Percentage of population that smokes, by gender")

```



The output provides a clear breakdown of the percentage of population that smokes, categorized by gender.

1. For males, 21.19% of them reported smoking, while the majority (78.81%) do not smoke. On the other hand, among females, only 16.38% reported smoking, while the majority (83.62%) do not smoke.

2. This indicates that both males and females have a higher percentage of non-smokers compared to smokers. However, there is a slightly higher prevalence of smoking among males compared to females.

This information can be useful for public health interventions and targeted smoking cessation programs, taking into account the gender-specific patterns of smoking behavior.


**calculating relative risk and an odds ratio for males compared to females**

* relative risk = 0.2119/0.1637 = 1.29

* odds for males = 0.2119/(1-0.2119) = 0.26  yes/no

* odds for females = 0.1637/(1-0.1637) = 0.19

* odds ratio = 0.31/0.12 = 1.36


The relative risk compares the risk of smoking between males and females. A relative risk of 1.29 means that males have a 1.29 times higher risk of smoking compared to females. This suggests that males are slightly more likely to be smokers than females.

The odds ratio compares the odds of smoking between males and females. An odds ratio of 1.36 means that the odds of smoking in males are 1.36 times higher than the odds of smoking in females. This indicates that males have slightly higher odds of being smokers compared to females.

It's important to note that while the relative risk and odds ratio indicate a small difference in smoking prevalence between males and females, the effect size is relatively modest. Other factors such as socio-cultural influences, socioeconomic status, and individual behaviors can also play a significant role in smoking patterns.

Efforts to reduce smoking rates should consider the gender-specific factors that contribute to smoking behavior. Tailored interventions and targeted strategies may be beneficial to address the higher smoking rates observed among males. These may include gender-specific smoking cessation programs, awareness campaigns, and policy measures to reduce smoking prevalence and promote healthier lifestyles for all genders.



#### Chi-squared test
```{r,echo = FALSE, warning=FALSE,message=FALSE}

q2<- n1 |> dplyr::select(q6,q52)|> # Select the variables of interest
  table() # Create a contingency table

chisq.test(q2) # Perform the chi-squared test
```



### 3. What percentage of the population smokes and how does this vary by socioeconomic status?
```{r, echo = FALSE, warning=FALSE,message=FALSE}

s3 <- n1 %>%
  dplyr::group_by(q6, key1) %>%
  dplyr::summarise(count = n()) |>
  drop_na() |>
  ungroup() %>%
  group_by(key1) %>%
  dplyr::mutate(perc = count/sum(count)*100) %>%
  dplyr::select(key1, q6, count)  # Create a summary table with counts and percentages of smokers by socioeconomic status (key1)


smoking_by_ses <- 
  s3 %>% 
  group_by(key1, q6) %>% 
  dplyr::summarise(count = sum(count)) %>% 
  ungroup() %>% 
  group_by(key1) %>% 
  dplyr::summarise(perc = count*100/sum(count),
                   q6 = q6) %>%   # Calculate the percentage of smokers within each socioeconomic status category
  arrange(key1)  


# Plot the results
ggplot(smoking_by_ses, aes(x = key1, y = perc, fill = q6)) +
  geom_bar(stat = "identity") +
  scale_fill_discrete(name = "Do You Smoke?") +
  labs(x = "Socioeconomic Status", y = "Percentage of Smokers") +
  theme(axis.text.x = element_text(angle = 90)) +
  scale_x_discrete(labels = function(x) stringr::str_wrap(x, width = 15)) +
  ggtitle("Smoking Rates by Socioeconomic Status")

```


The data reveals interesting patterns in smoking rates across different socioeconomic groups. 

1. Smoking Rates: The data reveals varying smoking rates among different socioeconomic groups. For example, the "A Employers and Managers" group has a smoking rate of 13.01%, while the "B Higher Professional" group has a smoking rate of 7.95%. On the other hand, the "G Unskilled" group has a higher smoking rate of 29.91%. These differences indicate that smoking behavior differs across socioeconomic categories.

2. Socioeconomic Disparities: The data highlights notable disparities in smoking rates across socioeconomic groups. Some groups, such as "A Employers and Managers" and "B Higher Professional," have relatively lower smoking rates, while groups like "G Unskilled" have higher smoking rates. These disparities suggest that socioeconomic factors play a role in smoking behavior.

3. Socioeconomic Influence: The data supports the hypothesis that socioeconomic status influences smoking rates. Higher socioeconomic groups tend to have lower smoking rates, potentially due to factors like better access to healthcare, higher awareness of health risks, and stronger social norms against smoking. In contrast, lower socioeconomic groups face more challenges in quitting smoking, such as limited resources for smoking cessation programs and higher exposure to smoking triggers.


In conclusion, the analysis of the data underscores the association between smoking rates and socioeconomic status. The findings indicate that smoking rates significantly vary across different socioeconomic groups, suggesting a link between socioeconomic factors and smoking behavior. These findings highlight the importance of considering socioeconomic disparities when implementing smoking cessation programs, tobacco control policies, and public health campaigns. 


Targeted interventions should focus on addressing the specific needs and challenges faced by different socioeconomic groups. Efforts should be made to provide accessible and affordable smoking cessation resources, education on the health risks of smoking, and supportive environments to help individuals quit smoking, particularly in higher-risk groups with higher smoking rates.

By understanding the relationship between smoking and socioeconomic status, policymakers, healthcare professionals, and public health advocates can develop comprehensive strategies to reduce smoking prevalence, promote healthier behaviors, and improve overall population health.



**calculating relative risk and an odds ratio for Unskilled compared to Employers and Managers**

* relative risk = 0.2991/0.1301 = 2.99


* odds for Unskilled = 0.2991/(1-0.2991) = 0.43

* odds for Employers and Managers = 0.1301/(1-0.1301) = 0.15  

* odds ratio = 0.43/0.15 = 2.87


The relative risk compares the risk of smoking between Unskilled workers and Employers/Managers. A relative risk of 2.99 means that Unskilled workers have a 2.99 times higher risk of smoking compared to Employers/Managers. This suggests that Unskilled workers are almost three times more likely to be smokers compared to Employers/Managers.

The odds ratio compares the odds of smoking between Unskilled workers and Employers/Managers. An odds ratio of 2.87 means that the odds of smoking in Unskilled workers are 2.87 times higher than the odds of smoking in Employers/Managers. This indicates that Unskilled workers have significantly higher odds of being smokers compared to Employers/Managers.

These findings highlight the importance of considering occupational factors when developing tobacco control and smoking cessation strategies. Unskilled workers may face unique challenges and higher levels of stress, which can contribute to higher smoking rates. Tailored interventions, workplace-based smoking cessation programs, and policies promoting smoke-free environments may be beneficial for reducing smoking prevalence among Unskilled workers.

It is important to address health disparities and provide support and resources for individuals in different occupational categories. By understanding the specific needs and challenges faced by Unskilled workers, targeted interventions can be developed to help reduce smoking rates and improve overall health outcomes.




#### Chi-squared test
```{r,echo = FALSE, warning=FALSE,message=FALSE}

q3<- n1 |> dplyr::select(q6,key1)|> # Select the variables of interest
  table() # Create a contingency table

chisq.test(q3) # Perform the chi-squared test
```



### 4. What are the observed variations in smoking rates across different local health offices (LHOs) in various counties?



```{r,echo = FALSE, warning=FALSE,message=FALSE}

# Recode the values in the lho variable to match the corresponding county names
n1$lho <- ifelse(n1$lho %in% c("Carlow/Kilkenny"), "Carlow/Kilkenny",
                 ifelse(n1$lho %in% c("Cavan/Monaghan"), "Cavan/Monaghan",
                 ifelse(n1$lho %in% c("Clare"), "Clare",
                 ifelse(n1$lho %in% c("Donegal"), "Donegal",
                 ifelse(n1$lho %in% c("Dublin North", "Dublin North Central", "Dublin North West", "Dublin South City", "Dublin South East", "Dublin South West", "Dublin West", "Dun Laoghaire"), "Dublin",
                 ifelse(n1$lho %in% c("Galway"), "Galway",
                 ifelse(n1$lho %in% c("Kerry"), "Kerry",
                 ifelse(n1$lho %in% c("Kildare/West Wicklow"), "Kildare",
                 ifelse(n1$lho %in% c("Laois/Offaly"), "Laois/Offaly",
                 ifelse(n1$lho %in% c("Limerick"), "Limerick",
                 ifelse(n1$lho %in% c("Longford/Westmeath"), "Longford/Westmeath",
                 ifelse(n1$lho %in% c("Louth"), "Louth",
                 ifelse(n1$lho %in% c("Mayo"), "Mayo",
                 ifelse(n1$lho %in% c("Meath"), "Meath",
                 ifelse(n1$lho %in% c("North Cork", "North Lee", "South Lee", "West Cork"), "Cork",
                 ifelse(n1$lho %in% c("Roscommon"), "Roscommon",
                 ifelse(n1$lho %in% c("Sligo/Leitrim/West Cavan"), "Sligo/Leitrim",
                 ifelse(n1$lho %in% c("Tipp/East Limerick", "Tipperary South"), "Tipperary",
                 ifelse(n1$lho %in% c("Waterford"), "Waterford",
                 ifelse(n1$lho %in% c("Wexford"), "Wexford",
                 ifelse(n1$lho %in% c("Wicklow"), "Wicklow", 
                        n1$lho)))))))))))))))))))))

# The code is creating a broader category called "Dublin" that includes various specific locations within Dublin (e.g., Dublin North, Dublin South, Dun Laoghaire, etc.). 

#All rows in the lho column that match any of the specified locations will be recoded as "Dublin," while rows with other locations will keep their original values. 

# The code is also recoding specific location names in the lho column into broader regional categories. For example, if a row in the lho column matches "Kildare/West Wicklow," it will be recoded as "Kildare." 

#Similarly, rows matching "North Cork," "North Lee," "South Lee," or "West Cork" will be recoded as "Cork." 

#Additionally, rows matching "Sligo/Leitrim/West Cavan" will be recoded as "Sligo/Leitrim."

#Rows matching "Tipp/East Limerick" or "Tipperary South" will be recoded as "Tipperary." This process simplifies the location information and allows for easier regional analysis.



# Group the data by smoking status (q6) and county (lho), then calculate the count of individuals in each combination

s4 <- n1 %>%
  dplyr::group_by(q6, lho) %>%
  dplyr::summarise(count = n()) |>  # Count the number of individuals in each smoking status and county combination
  drop_na() |>  # Drop rows with missing values
  ungroup() %>%
  group_by(lho) %>%
  dplyr::mutate(perc = count/sum(count)*100) |>  # Calculate the percentage of individuals in each group
  dplyr::select(lho, q6, count)  # Select relevant columns


# Calculate the percentage of smokers by region
smoking_by_region <- 
  s4 %>% 
  group_by(lho, q6) %>% 
  dplyr::summarise(count = sum(count)) %>% 
  ungroup() %>%
  group_by(lho) %>%
  dplyr::summarise(perc = count*100/sum(count),
                   q6 = q6) %>%
  arrange(lho)  # Calculate the percentage of smokers within each region


# Plot the results
ggplot(smoking_by_region, aes(x = lho, y = perc, fill = q6)) +
  geom_bar(stat = "identity") +
  scale_fill_discrete(name = "Do You Smoke?") +
  labs(x = "County", y = "Percentage") +
  theme(axis.text.x = element_text(angle = 90)) +
  ggtitle("Smoking Rates in Various Regions")
```


```{r,echo = FALSE, warning=FALSE,message=FALSE}
# for heatmaps

#write.csv(smoking_by_region, "smoking_by_region.csv", row.names=FALSE)
```


The provided table displays the smoking rates in different local health offices (LHOs) across various counties. It includes the LHO names (lho), the percentage of smokers or non-smokers (perc), and the smoking status (q6: "Yes" indicates smokers, "No" indicates non-smokers).


 * Starting with Carlow/Kilkenny, it is observed that 82.68% of individuals in this area are non-smokers, while the remaining 17.32% are smokers. Similarly, in Cavan/Monaghan, the majority of individuals (82.18%) do not smoke, with 17.82% being smokers. In Clare, the trend continues with 85.87% of individuals being non-smokers and 14.13% being smokers.


 * Moving on to Cork, the data reveals that 82.90% of individuals in this region do not smoke, while 17.10% are smokers. Likewise, in Donegal, the majority of individuals (83.86%) are non-smokers, whereas 16.14% are smokers. The trend continues in Dublin, where 81.84% of individuals are non-smokers, and the remaining 18.16% smoke.


 * In Galway, the data indicates that 78.89% of individuals do not smoke, while 21.11% are smokers. Similarly, in Kerry, the majority (82.89%) do not smoke, while 17.11% are smokers. The data for Kildare/West Wicklow shows that 84.46% of individuals do not smoke, and 15.54% are smokers.


 * Moving on to Laois/Offaly, it is observed that 77.55% of individuals in this area do not smoke, whereas 22.45% are smokers. In Limerick, the trend continues with 78.16% of individuals being non-smokers, and 21.84% being smokers. The data for Longford/Westmeath indicates that 77.27% of individuals do not smoke, while 22.73% are smokers.


 * In Louth, the majority of individuals (84.73%) are non-smokers, whereas 15.27% are smokers. In Mayo, a similar trend is observed, with 83.29% of individuals being non-smokers and 16.71% being smokers. The data for Meath shows that 82.19% of individuals do not smoke, while 17.81% are smokers.


 * Moving on to Roscommon, it is seen that 75.12% of individuals do not smoke, and 24.88% are smokers. In Sligo/Leitrim/West Cavan, the majority (79.91%) do not smoke, while 20.09% are smokers. The data for Tipperary indicates that 77.96% of individuals do not smoke, whereas 22.04% are smokers.


 * In Waterford, the trend continues with 81.21% of individuals being non-smokers, and 18.79% being smokers. Similarly, in Wexford, the majority (80.60%) do not smoke, while 19.40% are smokers. Finally, in Wicklow, 85.95% of individuals do not smoke, whereas 14.05% are smokers.




Conclusion:

The data provides insights into the smoking rates across various local health offices in Ireland. It shows that the percentage of smokers varies across different regions, ranging from around 14% to 86%. Some areas have higher percentages of non-smokers, while others have relatively higher proportions of smokers.

By understanding the smoking patterns at the regional level, public health authorities can develop targeted strategies to reduce smoking prevalence in specific areas. These may include awareness campaigns, smoking cessation programs, and policy interventions aimed at creating smoke-free environments and providing support for individuals to quit smoking. Additionally, the data can inform resource allocation and help prioritize interventions based on the identified areas with higher smoking rates.

It is important to note that smoking rates are influenced by various factors, including socioeconomic conditions, cultural norms, access to healthcare, and tobacco control policies. Therefore, a comprehensive approach that addresses these underlying determinants is crucial in achieving sustained reductions in smoking prevalence.


**calculating relative risk and an odds ratio for Roscommon compared to Meath**

* relative risk = 0.2488/0.1781 = 1.39


* odds for Roscommon = 0.2488/(1-0.2488) = 0.33

* odds for Meath = 0.1781/(1-0.1781) = 0.21  

* odds ratio = 0.33/0.21 = 1.57



The relative risk of smoking in Roscommon compared to Meath is 1.39. This suggests that individuals in Roscommon are 1.39 times more likely to smoke compared to individuals in Meath.


The odds ratio for smoking in Roscommon compared to Meath is 1.57. This indicates that the odds of smoking in Roscommon are 1.57 times higher than the odds of smoking in Meath.


These findings highlight regional disparities in smoking prevalence and suggest that there may be regional-specific factors influencing smoking behavior. Understanding the underlying determinants of higher smoking rates in Roscommon can help inform targeted interventions and policies to reduce smoking prevalence in that region. Such interventions may include community-based smoking cessation programs, increased access to tobacco cessation resources, and targeted public health campaigns.

It is important to address these regional disparities in smoking rates to promote equitable health outcomes and reduce the burden of smoking-related diseases. By identifying and targeting the unique challenges and risk factors in regions with higher smoking prevalence, effective strategies can be implemented to reduce smoking rates and improve the overall health of the population.



#### Chi-squared test
```{r,echo = FALSE, warning=FALSE,message=FALSE} 

q4<- n1 |> dplyr::select(q6,lho)|> # Select the variables of interest
  table() # Create a contingency table

chisq.test(q4) # Perform the chi-squared test
```


### 5. How do smoking rates vary based on the country of birth?

```{r, echo = FALSE, warning=FALSE,message=FALSE}

s5 <- n1 %>% 
  dplyr::group_by(q6, countbirth) %>%  # Grouping the data by smoking status and country of birth
  dplyr::summarise(count = n()) |>  # Counting the number of individuals in each combination
  drop_na() |>  # Dropping rows with missing values
  ungroup() %>%  # Removing grouping information
  group_by(countbirth) %>%  # Grouping the data by country of birth
  dplyr::mutate(perc = count/sum(count)*100) %>%  # Calculating the percentage within each group
  dplyr::select(countbirth, q6, count)  # Selecting relevant columns


smoking_by_country <- 
  s5 %>% 
  group_by(countbirth, q6) %>%  # Grouping the data by country of birth and smoking status
  dplyr::summarise(count = sum(count)) %>%  # Calculating the total count for each combination
  ungroup() %>% 
  group_by(countbirth) %>%  # Grouping the data by country of birth
  dplyr::summarise(perc = count*100/sum(count), q6 = q6) %>%  # Calculating the percentage within each country
  arrange(countbirth)  # Arranging the data by country of birth


# Plot the results
ggplot(smoking_by_country, aes(x = countbirth, y = perc, fill = q6)) +
  geom_bar(stat = "identity") +  # Creating a bar plot
  scale_fill_discrete(name = "Do you Smoke?") +  # Adding a legend for fill color
  labs(x = "Country", y = "Percentage") +  # Adding labels for x-axis and y-axis
  theme(axis.text.x = element_text(angle = 30, hjust = 1)) +  # Adjusting the appearance of x-axis labels
  ggtitle("Country-wise Distribution of Smoking Rates")  # Adding a title to the plot


```

The graph displays the smoking rates based on the country of birth. 

1. Smoking Rates by Country of Birth: The table presents the smoking rates among individuals based on their country of birth. For example, among individuals born in Ireland, 17.66% are smokers, while among those born in the UK, the smoking rate is 22.25%. These rates differ based on the country of birth, indicating variations in smoking behaviors among different populations.

2. Variation in Smoking Rates: The data highlights significant differences in smoking rates based on the country of birth. For instance, individuals born in the Rest of the World have a lower smoking rate of 11.05%, while those born in the Rest of EU have a higher rate of 34.46%. These disparities suggest that cultural and demographic factors associated with the country of birth may influence smoking behaviors.

3. Comparison by Country of Birth: The table allows for a comparison of smoking rates among individuals from different countries. For example, individuals born in Ireland have a relatively balanced smoking rate, with 17.66% being smokers. In contrast, individuals born in the Rest of the World exhibit a significantly lower smoking rate of 11.05%.

Understanding these variations can help in developing targeted interventions and tailored smoking cessation programs for specific populations. It emphasizes the importance of considering cultural and demographic factors associated with the country of birth when addressing smoking behaviors.



**calculating relative risk and an odds ratio for Ireland compared to Rest of EU**

* relative risk = 0.1765/0.3446 = 0.51


* odds for Ireland = 0.1765/(1-0.1765) = 0.21

* odds for Rest of EU = 0.3446/(1-0.3446) = 0.52 

* odds ratio = 0.43/0.15 = 0.41


The relative risk compares the risk of smoking between Ireland and the Rest of the EU. A relative risk of 0.51 suggests that individuals in Ireland have a 0.51 times lower risk of smoking compared to individuals in the Rest of the EU. This indicates that smoking prevalence is lower in Ireland compared to the Rest of the EU.

The odds ratio compares the odds of smoking between Ireland and the Rest of the EU. An odds ratio of 0.41 means that the odds of smoking in Ireland are 0.41 times lower than the odds of smoking in the Rest of the EU. This further supports the finding that individuals in Ireland have lower odds of being smokers compared to individuals in the Rest of the EU.


These findings reflect the effectiveness of tobacco control measures and public health campaigns in Ireland, which have contributed to a lower prevalence of smoking. The implementation of comprehensive tobacco control policies, including smoking bans, increased taxation on tobacco products, and public health education, has played a crucial role in reducing smoking rates in Ireland.

Continued efforts and investments in comprehensive tobacco control strategies are necessary to maintain and further reduce smoking rates, not only in Ireland but also in the Rest of the EU. By prioritizing evidence-based interventions and adopting best practices, public health authorities can contribute to improving population health and reducing the burden of smoking-related diseases.



### 6. What is the distribution of health conditions among smokers and non-smokers across different age classes and genders?

```{r, echo = FALSE, warning=FALSE,message=FALSE}

# converting the values "Fair", "Bad", and "Very Bad" to "Bad" and keeps the rest of the values as "Good" or "Very Good"

n1$spq1 <- ifelse(n1$spq1 %in% c("Fair", "Bad", "Very Bad"), "Bad", ifelse(n1$spq1 == "Good", "Good", "Very Good"))

# Select the relevant columns for analysis
s6 <- n1[c("q6", "ageclass", "q52", "spq1")]

# Calculate the percentage of smoking by health condition and age
h <- s6 %>%
  group_by(ageclass, q6, q52, spq1) %>%
  drop_na() |>  # Drop rows with missing values
  dplyr::summarize(count = n()) %>%  # Count the number of individuals in each combination
  ungroup() %>%
  group_by(q6, q52, ageclass) %>%
  dplyr::mutate(perc = count*100/sum(count))  # Calculate the percentage within each group

# Plot the results
ggplot(h, aes(x = ageclass, y = perc, fill = spq1)) +
  geom_bar(stat = "identity") +  # Create a bar plot
  scale_fill_discrete(name = "Health condition") +  # Add a legend for fill color
  labs(x = "Age", y = "Percentage") +  # Add labels for x-axis and y-axis
  ggtitle("Health Condition of people who smoke and who don't") +  # Add a title to the plot
  guides(color = guide_legend(reverse = TRUE)) +  # Reverse the order of the legend
  theme(axis.text.x = element_text(angle = 30, hjust = 1)) +  # Adjust the appearance of x-axis labels
  facet_grid(~(q6) + ~(q52), labeller = label_both)  # Create facets based on smoking status and gender


```



The provided data shows the distribution of individuals across different age groups (ageclass) and their smoking status (q6). The data also includes information about gender (GENDER), self-reported health status (spq1), and percentage of individuals in each category.


1. **Age Group: 15-24 years:**

   a) **Male:**
   
   * Non-smokers: 66.27% of non-smoking males reported very good health conditions.
   
   * Smokers: Among male smokers, 47.14% reported very good health conditions. This suggests that a significant proportion of male smokers still maintain good overall health.


   b) **Female:**
   
   * Non-smokers: 69.14% of non-smoking females reported very good health conditions.
   
   * Smokers: Among female smokers, 55.56% reported very good health conditions. This indicates that a considerable proportion of female smokers still enjoy good overall health.


2. **Age Group: 25-44 years:**

   a) **Male:**
   
   * Non-smokers: 62.03% of non-smoking males reported very good health conditions.
   
   * Smokers: Among male smokers, 55.89% reported very good health conditions. This suggests that a considerable proportion of male smokers still maintain good overall health.
   

   b) **Female:**
   
   * Non-smokers: 62.08% of non-smoking females reported very good health conditions.
   
   * Smokers: Among female smokers, 48.17% reported very good health conditions. This indicates that a significant proportion of female smokers still enjoy good overall health.


3. **Age Group: 45-64 years:**

   a) **Male:**
   
   * Non-smokers: 40.51% of non-smoking males reported very good health conditions.
   
   * Smokers: Among male smokers, 45.27% reported good health conditions. This suggests that a significant proportion of male smokers still maintain relatively good overall health.


   b) **Female:**
   
   * Non-smokers: 46.31% of non-smoking females reported very good health conditions.
   
   * Smokers: Among female smokers, 44.86% reported good health conditions. This indicates that a considerable proportion of female smokers still enjoy relatively good overall health.


4. **Age Group: 65 and over:**

   a) **Male:**
   
   * Non-smokers: 30.84% of non-smoking males reported bad health conditions.
   
   * Smokers: Among male smokers, 43.70% reported good health conditions. This suggests that a considerable proportion of male smokers still maintain relatively good overall health.


   b) **Female:**
   
   * Non-smokers: 28.76% of non-smoking females reported bad health conditions.
   
   * Smokers: Among female smokers, 47.47% reported good health conditions. This indicates that a significant proportion of female smokers still enjoys relatively good overall health.


   **Conclusion:** 
   
* In the 15-24 age group, both male and female non-smokers generally maintain very good health. Among smokers, a significant proportion still maintains good overall health, although the percentage is slightly lower than non-smokers.


* In the 25-44 age group, both male and female non-smokers generally maintain very good health. Among smokers, a considerable proportion still maintains good overall health, although the percentage is lower than non-smokers.
   
   
* In the 45-64 age group, both male and female non-smokers generally maintain good overall health. Among smokers, a significant proportion still maintains relatively good health conditions.

   
* In the 65 and over age group, both non-smoking males and females exhibit a higher prevalence of health issues. However, among smokers, a considerable proportion still maintains relatively good health conditions.
   
   
   
Overall, the analysis shows that while smoking can have negative health effects, a significant proportion of individuals across different age groups and genders still maintain good or very good health despite being smokers. It's important to note that quitting smoking is generally associated with better health outcomes. These findings highlight the need for smoking cessation efforts and personalized health considerations when assessing the relationship between smoking and health outcomes.



### 7. In the last 12 months, how often you have a smoking habit, and do you have private health insurance?


```{r, echo = FALSE, warning=FALSE,message=FALSE}

# Select the relevant columns for analysis
s7 <- n1[c("q6", "q52", "ageclass", "q55")]


# Calculate the percentage of individuals with private health insurance by smoking status, gender, and age
health_ins_smoke <- s7 %>%
  group_by(q6, q52, ageclass, q55) %>%
  drop_na() |>  # Drop rows with missing values
  dplyr::summarize(count = n()) %>%  # Count the number of individuals in each combination
  ungroup() %>%
  group_by(q6, q52, ageclass) %>%
  dplyr::mutate(perc = count*100/sum(count))  # Calculate the percentage within each group


# Plot the results
ggplot(health_ins_smoke, aes(x = ageclass, y = perc, fill = q55)) +
  geom_bar(stat = "identity") +  # Create a bar plot
  scale_fill_discrete(name = "Do you have private health insurance?") +  # Add a legend for fill color
  labs(x = "Age", y = "Percentage") +  # Add labels for x-axis and y-axis
  ggtitle("Percentage of Individuals with Private Health Insurance by \nSmoking Status, Gender, and Age Group") +  # Add a title to the plot
  guides(color = guide_legend(nrow = 2, byrow = TRUE, reverse = TRUE)) +  # Adjust the appearance of the legend
  theme(axis.text.x = element_text(angle = 90, vjust = 0, hjust = 1), plot.title = element_text(lineheight = 1.1)) +  # Adjust the appearance of the x-axis labels and plot title
  facet_grid(~(q6) + ~(q52), labeller = label_both)  # Create facets based on smoking status and gender

```


Let's analyze the relationship between smoking status, gender, age group, and the possession of private health insurance:

1. **Smoking Status: No**

   a) **Male:**
   
   * Age Group: 15-24 years: Among non-smoking males, 56.86% do not have private health insurance, while 43.14% have private health insurance.
   
   * Age Group: 25-44 years: Among non-smoking males, 51.62% do not have private health insurance, while 48.38% have private health insurance.
   
   * Age Group: 45-64 years: Among non-smoking males, 44.44% do not have private health insurance, while 55.56% have private health insurance.
   
   * Age Group: 65 and over: Among non-smoking males, 52.10% do not have private health insurance, while 47.90% have private health insurance.
   

   b) **Female:**
   
   * Age Group: 15-24 years: Among non-smoking females, 58.02% do not have private health insurance, while 41.98% have private health insurance.
   
   * Age Group: 25-44 years: Among non-smoking females, 50.81% do not have private health insurance, while 49.19% have private health insurance.
   
   * Age Group: 45-64 years: Among non-smoking females, 41.63% do not have private health insurance, while 58.37% have private health insurance.
   
   * Age Group: 65 and over: Among non-smoking females, 48.13% do not have private health insurance, while 51.87% have private health insurance.


2. **Smoking Status: Yes**

   a) **Male:**
   
   * Age Group: 15-24 years: Among smoking males, 75.71% do not have private health insurance, while 24.29% have private health insurance.
   
   * Age Group: 25-44 years: Among smoking males, 76.77% do not have private health insurance, while 23.23% have private health insurance.
   
   * Age Group: 45-64 years: Among smoking males, 75.31% do not have private health insurance, while 24.69% have private health insurance.
   
   * Age Group: 65 and over: Among smoking males, 77.31% do not have private health insurance, while 22.69% have private health insurance.
   

   b) **Female:**
   
   * Age Group: 15-24 years: Among smoking females, 81.48% do not have private health insurance, while 18.52% have private health insurance.
   
   * Age Group: 25-44 years: Among smoking females, 83.39% do not have private health insurance, while 16.61% have private health insurance.
   
   * Age Group: 45-64 years: Among smoking females, 72.02% do not have private health insurance, while 27.98% have private health insurance.
   
   * Age Group: 65 and over: Among smoking females, 70.71% do not have private health insurance, while 29.29% have private health insurance.


**Conclusion:**

  * Private health insurance appears to have a somewhat mitigating effect on smoking rates, particularly among females. Females with private health insurance generally have lower smoking rates compared to females without private health insurance in most age groups.


  * Among males, the influence of private health insurance on smoking rates is not as pronounced, with some age groups showing slightly higher smoking rates among those with private health insurance.
    
  * The highest smoking rates are observed among individuals without private health insurance, particularly among females aged 45-64 years and males aged 45-64 years and 65 and over.

  * These findings highlight the importance of promoting smoking cessation programs, public health campaigns, and access to affordable healthcare, including private health insurance, to address and reduce smoking rates, especially among vulnerable populations.



### 8. What is the relationship between the prevalence of smoking among the surveyed individuals based on their age group and their status as the Chief Income Earner in their household?


```{r, echo = FALSE, warning=FALSE,message=FALSE}

# Select the relevant variabels for analysis
s8 <- n1[c("q6", "ageclass", "q63b")]


# Calculate the percentage of individuals by smoking status, age group, and chief income earner category
income <- s8 %>%
  group_by(ageclass, q63b, q6) %>%
  drop_na() |>  # Drop rows with missing values
  dplyr::summarize(count = n()) %>%  # Count the number of individuals in each combination
  ungroup() %>%
  group_by(ageclass, q63b) %>%
  dplyr::mutate(perc = count*100/sum(count), q6 = q6)  # Calculate the percentage within each group


# Plot the results
ggplot(income, aes(x = ageclass, y = perc, fill = q6)) +
  geom_bar(stat = "identity") +  # Create a bar plot
  scale_fill_discrete(name = "Do You Smoke?") +  # Add a legend for fill color
  labs(x = "Age", y = "Percentage") +  # Add labels for x-axis and y-axis
  ggtitle("Percentage of Individuals by Smoking Status, Age Group, and Chief Income Earner") +  # Add a title to the plot
  guides(color = guide_legend(reverse = TRUE)) +  # Adjust the appearance of the legend
  theme(axis.text.x = element_text(angle = 30, hjust = 1)) +  # Adjust the appearance of the x-axis labels
  facet_wrap(~q63b, labeller = label_both)  # Create multiple plots based on chief income earner category


```



Based on the breakdown of being the Chief Income Earner in the household (q63b) by age class (AGECLASS) and smoking status (q6):

1. **Age Class: 15-24 years**:

   * Among individuals aged 15-24 years, the majority (85.98%) are not the Chief Income Earner in their household, regardless of their smoking status.
  
   * Among those who are not the Chief Income Earner, the count is 417, representing a significant proportion of this age group.
  
   * Among those who are the Chief Income Earner, the count is 137, with a higher percentage (40.88%) for non-smokers compared to smokers (14.02%).


2. **Age Class: 25-44 years**:

   * In the age group of 25-44 years, a majority of individuals (81.70%) who are not the Chief Income Earner, regardless of their smoking status.
   
   * The count for individuals not holding the role of Chief Income Earner is 634, indicating a significant portion of this age group.
   
   * Among those who are the Chief Income Earner, the count is 456, with a higher percentage (73.69%) for non-smokers compared to smokers (26.31%).


3. **Age Class: 45-64 years**:
  
   * Among individuals aged 45-64 years, the majority (85.63%) who are not the Chief Income Earner in their household, regardless of their smoking status.
  
   * The count for individuals not holding the role of Chief Income Earner is 572, representing a significant proportion of this age group.
  
   * Among those who are the Chief Income Earner, the count is 390, with a higher percentage (78.75%) for non-smokers compared to smokers (21.25%).


4. **Age Class: 65 and over**:

   * In the age group of 65 and over, the majority (93.38%) who are not the Chief Income Earner in their household, regardless of their smoking status.
  
   * The count for individuals not holding the role of Chief Income Earner is 282, indicating a significant portion of this age group.
  
   * Among those who are the Chief Income Earner, the count is 198, with a higher percentage (88.77%) for non-smokers compared to smokers (11.23%).


Overall, the data indicates that across all age classes, a larger percentage of individuals are not the Chief Income Earner in their household, irrespective of their smoking status. However, among those who hold the role of Chief Income Earner, there is a higher percentage of non-smokers compared to smokers in each age group.

It's important to note that being the Chief Income Earner can depend on various factors such as education, occupation, and household dynamics. Further analysis and consideration of these factors would be necessary to draw more definitive conclusions.




### 9. What percentage of the population consumes alcohol and how does this vary by age?

```{r, echo = FALSE, warning=FALSE,message=FALSE}

# Recode values in column q14 to "Yes" and "No"
n1$q14 <- ifelse(n1$q14 %in% c("Yes", "Have only had a few sips of alcohol in my lifetime"), "Yes", "No")


# Group the data by alcohol consumption and age group, and calculate counts
s9 <- n1 %>% 
  dplyr::group_by(q14, ageclass) %>% 
  dplyr::summarise(count = n()) |>  # Count the number of individuals in each combination
  drop_na() |>  # Drop rows with missing values
  ungroup() %>%
  group_by(ageclass) %>%
  dplyr::mutate(perc = count/sum(count)*100) |>  # Calculate the percentage within each age group
  dplyr::select(ageclass, q14, count)  # Select relevant columns


# Calculate the percentage of individuals by alcohol consumption and age group
drinking_by_age <- 
  s9 %>% 
  group_by(ageclass, q14) %>% 
  dplyr::summarise(count = sum(count)) %>% 
  ungroup() %>% 
  group_by(ageclass) %>% 
  dplyr::summarise(perc = count*100/sum(count),
                   q14 = q14) %>% 
  arrange(ageclass)  # Arrange the data by age group


# Plot the results
ggplot(drinking_by_age, aes(x = ageclass, y = perc, fill = q14)) +
  geom_bar(stat = "identity") +  # Create a bar plot
  scale_fill_discrete(name = "Do you consume alcohol?") +  # Add a legend for fill color
  labs(x = "Age", y = "Percentage") +  # Add labels for x-axis and y-axis
  ggtitle("Alcohol Consumption by Age Group") +  # Add a title to the plot
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))  # Adjust the appearance of the x-axis labels

```


1. **Age Group "15-24 years"**: The majority of individuals in this age group (77.33%) consume alcohol, while a smaller percentage (22.67%) do not consume alcohol.

2. **Age Group "25-44 years"**: A significant majority of individuals in this age group (91.07%) consume alcohol, with only a small percentage (8.93%) not consuming alcohol.

3. **Age Group "45-64 years"**: A high percentage of individuals in this age group (87.50%) consume alcohol, while a relatively smaller percentage (12.50%) do not consume alcohol.

4. **Age Group "65 and over"**: The majority of individuals in this age group (80.48%) consume alcohol, while a smaller percentage (19.52%) do not consume alcohol.

Overall, the data suggests that alcohol consumption tends to be more prevalent among younger age groups (15-24 years and 25-44 years) compared to older age groups (45-64 years and 65 and over).



**calculating relative risk and an odds ratio (Alcohol consumption) for 25-44 year olds compared to 65 +**

* relative risk = 0.9107/0.8048 = 1.13

* odds for 25-44 = 0.9107/(1-0.9107) = 10.19

* odds for 65+ = 0.8048/(1-0.8048) = 4.12

* odds ratio = 0.31/0.12 = 2.47


The relative risk of 1.13 indicates that individuals in the 25-44 age group have a 1.13 times higher risk of consuming alcohol compared to those in the 65 and over age group. This suggests a slightly higher prevalence of alcohol consumption in the younger age group.

The odds ratio of 2.47 implies that the odds of alcohol consumption are 2.47 times higher in the 25-44 age group compared to the 65 and over age group. This indicates a significant difference in alcohol consumption patterns between the two age groups, with a higher likelihood of alcohol consumption in the younger age group.


These findings align with general trends in alcohol consumption, where younger individuals tend to have higher rates of alcohol use. It is important to address alcohol consumption behaviors, particularly among younger age groups, through education, awareness campaigns, and targeted interventions to promote responsible and healthy alcohol consumption habits. Additionally, efforts to prevent alcohol-related harm should also be focused on older age groups, as a significant proportion of individuals in these age groups still consume alcohol.


#### Chi-squared test
```{r,echo = FALSE, warning=FALSE,message=FALSE}

q5 <- n1 %>%
  dplyr::select(q14, ageclass) |>  # Select the variables of interest
  table()  # Create a contingency table

chisq.test(q5)  # Perform the chi-squared test

```




### 10. What percentage of the population consumes alcohol and how does this vary by gender?
```{r, echo = FALSE, warning=FALSE,message=FALSE}

# Group the data by alcohol consumption and gender, and calculate counts
s10 <- n1 %>% 
  dplyr::group_by(q14, q52) %>% 
  dplyr::summarise(count = n()) |>  # Count the number of individuals in each combination
  drop_na() |>  # Drop rows with missing values
  ungroup() %>%
  group_by(q52) %>%
  dplyr::mutate(perc = count/sum(count)*100) |>  # Calculate the percentage within each gender
  dplyr::select(q52, q14, count)  # Select relevant columns


# Calculate the percentage of individuals by alcohol consumption and gender
drinking_by_gender <- 
  s10 %>% 
  group_by(q52, q14) %>% 
  dplyr::summarise(count = sum(count)) %>% 
  ungroup() %>% 
  group_by(q52) %>% 
  dplyr::summarise(perc = count*100/sum(count),
                   q14 = q14) %>% 
  arrange(q52)  # Arrange the data by gender


# Plot the results
ggplot(drinking_by_gender, aes(x = q52, y = perc, fill = q14)) +
  geom_bar(stat = "identity") +  # Create a bar plot
  scale_fill_discrete(name = "Do you consume alcohol?") +  # Add a legend for fill color
  labs(x = "Gender", y = "Percentage") +  # Add labels for x-axis and y-axis
  theme(axis.text.x = element_text(hjust = 1)) +  # Adjust the appearance of the x-axis labels
  ggtitle("Alcohol Consumption by Gender")  # Add a title to the plot

```

Males: Among males, a significant majority (88.88%) consume alcohol, while a relatively smaller percentage (11.12%) do not consume alcohol.

Females: Among females, the majority (83.60%) consume alcohol, while a smaller percentage (16.40%) do not consume alcohol.

Based on the provided data, it appears that both males and females have a substantial proportion of individuals who consume alcohol. 


**calculating relative risk and an odds ratio (Alcohol consumption) for males compared to females**

* relative risk = 0.8888/0.8359 = 1.06

* odds for males = 0.8888/(1-0.8888) = 7.99

* odds for females = 0.8359/(1-0.8359) = 5.09

* odds ratio = 7.99/5.09 = 1.56

The calculated relative risk of 1.06 suggests that males have a 1.06 times higher risk of consuming alcohol compared to females. This indicates a slightly higher prevalence of alcohol consumption among males, although the difference is not substantial.

The odds ratio is 1.56, indicating that males have 1.56 times higher odds of consuming alcohol compared to females. This suggests a moderate association between gender and alcohol consumption, with males having higher odds of being alcohol consumers compared to females.


Based on the data, it can be concluded that there is a moderate association between gender and alcohol consumption. Males have a slightly higher prevalence and odds of consuming alcohol compared to females. The findings emphasize the need for comprehensive alcohol-related interventions and education for both genders to promote responsible alcohol consumption and address potential health risks associated with excessive alcohol use.


#### Chi-squared test
```{r,echo = FALSE, warning=FALSE,message=FALSE}

q6<- n1 |> dplyr::select(q14,q52)|> # Select the variables of interest
  table() # Create a contingency table

chisq.test(q6) # Perform the chi-squared test
```



### 11. What percentage of the population consumes alcohol, and how does this vary by socioeconomic status?

```{r, echo = FALSE, warning=FALSE,message=FALSE}

# Group the data by alcohol consumption and socioeconomic status, and calculate counts
s11 <- n1 %>% 
  dplyr::group_by(q14, key1) %>% 
  dplyr::summarise(count = n()) |>  # Count the number of individuals in each combination
  drop_na() |>  # Drop rows with missing values
  ungroup() %>%
  group_by(key1) %>%
  dplyr::mutate(perc = count/sum(count)*100) |>  # Calculate the percentage within each socioeconomic status
  dplyr::select(key1, q14, count)  # Select relevant columns


# Calculate the percentage of individuals by alcohol consumption and socioeconomic status
drinking_by_sec <- 
  s11 %>% 
  group_by(key1, q14) %>% 
  dplyr::summarise(count = sum(count)) %>% 
  ungroup() %>% 
  group_by(key1) %>% 
  dplyr::summarise(perc = count*100/sum(count),
                   q14 = q14) %>% 
  arrange(key1)  # Arrange the data by socioeconomic status


# Plot the results
ggplot(drinking_by_sec, aes(x = key1, y = perc, fill = q14)) +
  geom_bar(stat = "identity") +  # Create a bar plot
  scale_fill_discrete(name = "Do you consume alcohol?") +  # Add a legend for fill color
  labs(x = "Socioeconomic status", y = "Percentage") +  # Add labels for x-axis and y-axis
  theme(axis.text.x = element_text(angle = 90)) +  # Adjust the appearance of the x-axis labels
  scale_x_discrete(labels = function(x) stringr::str_wrap(x, width = 15)) +  # Wrap long x-axis labels
  ggtitle("Alcohol Consumption by Socioeconomic Status")  # Add a title to the plot

```


The data shows the varying patterns of alcohol consumption among different social economic groups. Here are some key observations:

1. Employers and Managers (Group A) have a high percentage (90.56%) of individuals consuming alcohol, while a relatively lower percentage (9.44%) do not consume alcohol.

2. Higher Professional (Group B) also has a high percentage (90.91%) of individuals consuming alcohol, with a similar pattern as Group A.

3. The percentage of alcohol consumers gradually decreases in subsequent groups such as Lower Professional (Group C), Non-Manual (Group D), Manual Skilled (Group E), Semi-Skilled (Group F), Unskilled (Group G), Own Account Workers (Group H), Farmers (Group I), Agricultural Workers (Group J), and All others gainfully occupied and unknown (Group Z).

4. Among Agricultural Workers (Group J), the percentage of alcohol consumers (73.68%) is relatively lower compared to other groups.

These findings suggest that there are variations in alcohol consumption patterns across different social economic groups. Factors such as occupation, income, and social status may influence these patterns. 


**calculating relative risk and an odds ratio (Alcohol consumption) for Employers and Managers compared to Agricultural Workers**

* relative risk = 0.9056/0.7368 = 1.06

* odds for Employers and Managers = 0.9056/(1-0.9056) = 9.59

* odds for Agricultural Workers = 0.7368/(1-0.7368) = 2.79

* odds ratio = 9.59/2.79 = 3.43


The calculated relative risk of 1.06 suggests that Employers and Managers have a 1.06 times higher risk of consuming alcohol compared to Agricultural Workers. This indicates a slightly higher prevalence of alcohol consumption among Employers and Managers, although the difference is not substantial.

The odds ratio is 3.43, indicating that Employers and Managers have 3.43 times higher odds of consuming alcohol compared to Agricultural Workers. This suggests a moderate association between occupational group and alcohol consumption, with Employers and Managers having higher odds of being alcohol consumers compared to Agricultural Workers.


Based on the data, it can be concluded that there is a moderate association between occupational group and alcohol consumption. These findings highlight the importance of considering occupational factors when addressing alcohol consumption patterns and implementing workplace wellness programs that promote responsible drinking behavior. It is essential to provide resources, support, and education on alcohol consumption within different occupational settings to ensure the well-being and safety of all individuals.


#### Chi-squared test
```{r,echo = FALSE, warning=FALSE,message=FALSE}

q7<- n1 |> dplyr::select(q14,key1)|> # Select the variables of interest
  table() # Create a contingency table

chisq.test(q7) # Perform the chi-squared test
```



### 12. What are the patterns of alcohol consumption across different local health offices (LHOs) within each county?

```{r, echo = FALSE, warning=FALSE,message=FALSE}

# Group the data by alcohol consumption and region, and calculate counts
s12 <- n1 %>% 
  dplyr::group_by(q14, lho) %>% 
  dplyr::summarise(count = n()) |>  # Count the number of individuals in each combination
  drop_na() |>  # Drop rows with missing values
  ungroup() %>%
  group_by(lho) %>%
  dplyr::mutate(perc = count/sum(count)*100) |>  # Calculate the percentage within each region
  dplyr::select(lho, q14, count)  # Select relevant columns


# Calculate the percentage of individuals by alcohol consumption and region
drinking_by_region <- 
  s12 %>% 
  group_by(lho, q14) %>% 
  dplyr::summarise(count = sum(count)) %>% 
  ungroup() %>% 
  group_by(lho) %>% 
  dplyr::summarise(perc = count*100/sum(count),
                   q14 = q14) %>% 
  arrange(lho)  # Arrange the data by region


# Plot the results
ggplot(drinking_by_region, aes(x = lho, y = perc, fill = q14)) +
  geom_bar(stat = "identity") +  # Create a bar plot
  scale_fill_discrete(name = "Do you consume alcohol?") +  # Add a legend for fill color
  labs(x = "Region", y = "Percentage") +  # Add labels for x-axis and y-axis
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +  # Adjust the appearance of the x-axis labels
  ggtitle("Alcohol Consumption by Region")  # Add a title to the plot

```


The table provides the percentage of individuals who consume alcohol (q14) in each region (lho). The "No" category represents individuals who do not consume alcohol, while the "Yes" category represents those who do.



Carlow/Kilkenny, Cavan/Monaghan, Clare, and Cork are regions where a significant majority of individuals consume alcohol. The percentages of drinkers in these regions are 81.89%, 91.58%, 85.87%, and 86.74%, respectively. This suggests a prevalent drinking culture in these areas, with a higher prevalence of alcohol consumption among the population.

In contrast, regions like Donegal, Kerry, Meath, and Sligo/Leitrim/West Cavan have a higher proportion of non-drinkers. In Donegal, 75.66% of individuals do not consume alcohol, highlighting a notable difference compared to other regions. These findings suggest potential cultural or lifestyle factors influencing drinking behaviors in these areas.

Dublin, as the capital city, stands out with a higher percentage of drinkers (88.84%). This indicates a prevalent drinking culture in the city, potentially influenced by factors such as social activities, nightlife, and urban lifestyle.

Examining the regional variations in alcohol consumption is essential for public health officials and policymakers. It allows them to better understand the unique challenges and needs of each region regarding alcohol-related issues. By recognizing areas with higher rates of alcohol consumption, targeted interventions and educational campaigns can be developed to address harmful drinking patterns and promote responsible alcohol use.

Moreover, the regions with a higher proportion of non-drinkers, such as Donegal and Sligo/Leitrim/West Cavan, may offer opportunities to explore factors contributing to lower alcohol consumption rates. Understanding the cultural, socioeconomic, and environmental influences that contribute to these patterns can help inform interventions aimed at reducing alcohol-related harms and promoting healthier behaviors.

In conclusion, the findings indicate significant regional variations in alcohol consumption across Ireland. The results can guide policymakers, public health officials, and community leaders in tailoring strategies and interventions to address alcohol-related challenges specific to each region. By promoting responsible drinking behaviors and fostering a better understanding of alcohol's impact on health and well-being, efforts can be made to create a safer and healthier drinking culture throughout the country.



**calculating relative risk and an odds ratio (Alcohol consumption) for Galway compared to Limerick**

* relative risk = 0.8912/0.8544 = 1.04

* odds for Galway = 0.8912/(1-0.8912) = 8.19

* odds for Limerick = 0.8544/(1-0.8544) = 5.86

* odds ratio = 8.19/5.86 = 1.39


The relative risk compares the likelihood of alcohol consumption between two groups. In this case, the relative risk of Galway compared to Limerick is calculated by dividing the percentage of drinkers in Galway (89.12%) by the percentage of drinkers in Limerick (85.44%). The result is 1.04, indicating that individuals in Galway have a slightly higher risk of alcohol consumption compared to those in Limerick.


The odds for alcohol consumption in Galway can be calculated by dividing the percentage of drinkers (89.12%) by the percentage of non-drinkers (100% - 89.12% = 10.88%). This gives us an odds value of 8.19, meaning that individuals in Galway are approximately 8.19 times more likely to consume alcohol than to not consume it. Similarly, the odds for alcohol consumption in Limerick can be calculated using the percentage of drinkers (85.44%) and the percentage of non-drinkers (100% - 85.44% = 14.56%). The odds value for Limerick is approximately 5.86, indicating that individuals in Limerick are about 5.86 times more likely to consume alcohol than to not consume it. 


The odds ratio compares the odds of an event occurring between two groups. In this case, the odds ratio for Galway compared to Limerick is calculated by dividing the odds for Galway (8.19) by the odds for Limerick (5.86). The result is approximately 1.39, suggesting that individuals in Galway have 1.39 times higher odds of consuming alcohol compared to those in Limerick.


These calculations provide insights into the differences in alcohol consumption between Galway and Limerick. While Galway has a slightly higher relative risk and higher odds of alcohol consumption compared to Limerick, the differences are relatively small. 


These findings highlight the importance of considering regional variations in alcohol consumption patterns and tailoring interventions and policies to address the specific needs and challenges of different areas. It is essential to promote responsible drinking behaviors and provide support and resources for individuals in both Dublin South East and Limerick to ensure the well-being and health of the population.


#### Chi-squared test
```{r,echo = FALSE, warning=FALSE,message=FALSE} 

q8<- n1 |> dplyr::select(q14,lho)|> # Select the variables of interest
  table() # Create a contingency table

chisq.test(q8) # Perform the chi-squared test
```



### 13. How does alcohol consumption vary among the surveyed individuals based on their country of birth?


```{r, echo = FALSE, warning=FALSE,message=FALSE}

# Group the data by alcohol consumption and country of birth, and calculate counts
s13 <- n1 %>% 
  dplyr::group_by(q14, countbirth) %>% 
  dplyr::summarise(count = n()) |>
  drop_na() |>
  ungroup() %>%
  group_by(countbirth) %>%
  dplyr::mutate(perc = count/sum(count)*100) %>%
  dplyr::select(countbirth, q14, count)


# Calculate the percentage of individuals by alcohol consumption
drinking_by_country <- 
  s13 %>% 
  group_by(countbirth, q14) %>% 
  dplyr::summarise(count = sum(count)) %>% 
  ungroup() %>% 
  group_by(countbirth) %>% 
  dplyr::summarise(perc = count*100/sum(count),
                   q14 = q14) %>% 
  arrange(countbirth)


# Plot the results
ggplot(drinking_by_country, aes(x = countbirth, y = perc, fill = q14)) +
  geom_bar(stat = "identity") +
  scale_fill_discrete(name = "Do you Consume Alcohol?") +
  labs(x = "County", y = "Percentage")+
  theme(axis.text.x = element_text(angle = 30,hjust=1))+
  ggtitle ("Variations in Alcohol Consumption Based on Country of Birth")

```



The graph displays the alcohol consumption rates based on the country of birth.

1. Alcohol Consumption Rates by Country of Birth: The table presents the alcohol consumption rates among individuals based on their country of birth. For example, among individuals born in Ireland, 86.53% consume alcohol, while among those born in the UK, the consumption rate is 90.43%. These rates vary based on the country of birth, indicating differences in alcohol consumption behaviors among different populations.

2. Variation in Alcohol Consumption Rates: The data reveals significant variations in alcohol consumption rates based on the country of birth. For instance, individuals born in the Rest of the World have a lower alcohol consumption rate of 67.37%, while those born in the Rest of EU have a higher rate of 87.29%. These disparities suggest that cultural and demographic factors associated with the country of birth may influence alcohol consumption behaviors.

3. Comparison by Country of Birth: The table allows for a comparison of alcohol consumption rates among individuals from different countries. For example, individuals born in Ireland have a relatively high alcohol consumption rate of 86.53%, whereas individuals born in the Rest of the World exhibit a lower consumption rate of 67.37%.

Understanding these variations in alcohol consumption rates can inform the development of targeted interventions and tailored alcohol awareness programs for specific populations. It underscores the significance of considering cultural and demographic factors associated with the country of birth when addressing alcohol consumption behaviors.


**calculating relative risk and an odds ratio (Alcohol Consumption) for Ireland compared to Rest of EU**

* relative risk = 0.8653/0.8728 = 0.99


* odds for Ireland = 0.8653/(1-0.8653) = 6.42

* odds for Rest of EU = 0.8728/(1-0.8728) = 6.86 

* odds ratio = 6.42/6.86 = 0.93


The relative risk compares the risk of alcohol consumption between Ireland and the Rest of the EU. A relative risk of 0.99 suggests that individuals in Ireland have a similar risk of alcohol consumption compared to individuals in the Rest of the EU. This indicates that alcohol consumption rates are comparable between Ireland and the Rest of the EU.

The odds ratio compares the odds of alcohol consumption between Ireland and the Rest of the EU. An odds ratio of 0.93 means that the odds of alcohol consumption in Ireland are 0.93 times lower than the odds of alcohol consumption in the Rest of the EU. This suggests that individuals in Ireland have slightly lower odds of being alcohol consumers compared to individuals in the Rest of the EU.

These findings indicate that there is no significant difference in alcohol consumption rates between Ireland and the Rest of the EU. The prevalence of alcohol consumption seems to be similar in both populations.


Understanding the factors influencing alcohol consumption behaviors is essential for public health interventions and policies aimed at promoting responsible drinking and reducing alcohol-related harms. Continued monitoring and evaluation of alcohol consumption trends can inform targeted interventions and strategies to address alcohol misuse and promote healthier behaviors.

### 14. How does the distribution of alcohol consumption vary among different age classes and genders in relation to health conditions?


```{r, echo = FALSE, warning=FALSE,message=FALSE}

# Select the columns related to alcohol consumption, age group, gender, and health condition from the dataset and assign them to "s14"

s14 <- n1[c("q14", "ageclass", "q52", "spq1")]


# Calculate the percentage of smoking by age, gender, and health condition
h1 <- s14 %>%
  group_by(q14,ageclass,q52,spq1) %>% # Group the dataframe by alcohol consumption, age group, gender, and health condition

  drop_na() |> # Remove rows with missing values
  dplyr::summarize(count = n()) %>% # Calculate the count of individuals in each combination
  ungroup() %>%
  group_by(q14,q52,ageclass) %>% # Group the dataframe again by alcohol consumption, gender, and age group
  dplyr::mutate(perc = count*100/sum(count),q14=q14)  # Calculate the percentage of individuals in each combination


# Plot the results
ggplot(h1, aes(x = ageclass, y = perc, fill = spq1)) + # Create a bar plot with age group on the x-axis, percentage on the y-axis, and health condition as fill color
  geom_bar(stat = "identity") +
  scale_fill_discrete(name = "Health condition") +
  labs(x = "Age", y = "Percentage")+
  ggtitle("Distribution of Health Conditions and Alcohol Consumption by Age and Gender")+
  guides(color = guide_legend(reverse = TRUE))+  # Reverse the order of the legend
  theme(axis.text.x = element_text(angle = 30,hjust=1))+  # Adjust the angle of x-axis labels for better readability
  facet_grid(~(q14)+ ~(q52),labeller = label_both) # Facet the plot by alcohol consumption and gender

```


The analysis examined the relationship between alcohol consumption and health conditions, specifically comparing individuals who consume alcohol to those who do not. The findings are as follows:


1. **Age Group: 15-24 years:**

   a) **Male:**
   
   * Non-consumers (No): Only 1.64% of males in this age group reported bad health conditions. This indicates that the majority of non-drinkers in this age range maintain good or very good health.
   
   * Consumers (Yes): Among the male drinkers, 7.20% reported bad health conditions. However, a significant portion (59.85%) reported very good health conditions. This suggests that while some drinkers face negative health effects, a considerable number still maintain good health.

   b) **Female:**
   
   * Non-consumers (No): 3.75% of females who don't consume alcohol reported bad health conditions. Similar to males, most non-drinkers in this age group experience good or very good health.
   
   * Consumers (Yes): Among female drinkers, 6.91% reported bad health conditions. However, a higher percentage (63.59%) reported very good health conditions. This implies that despite some negative health outcomes, a significant proportion of female drinkers still enjoy good overall health.
   

2. **Age Group: 25-44 years:**

   a) **Male:**
   
   * Non-consumers (No): 18.31% of non-drinking males reported bad health conditions, which is significantly higher than in the previous age group. This indicates a higher prevalence of health issues among non-drinkers in this age range.
   
   * Consumers (Yes): Among male drinkers, 8.28% reported bad health conditions, while 60.77% reported very good health conditions. This suggests that while there are some negative health consequences associated with alcohol consumption, a significant portion of male drinkers still maintain very good health.


   b) **Female:**
   
   * Non-consumers (No): 10.46% of females who abstain from alcohol reported bad health conditions, which is lower than the rate among non-drinking males but still relatively high compared to the younger age group.
   
   * Consumers (Yes): Among female drinkers, 8.11% reported bad health conditions, while 32.07% reported very good health conditions. This indicates that despite some negative health effects, a considerable proportion of female drinkers still enjoy good overall health.


3. **Age Group: 45-64 years:**

   a) **Male:**
   
   * Non-consumers (No): The percentage of non-drinking males reporting bad health conditions further increases to 27.12%. This suggests a higher prevalence of health issues among non-drinkers in this age group.
   
   * Consumers (Yes): Among male drinkers, 20.73% reported bad health conditions, while 36.60% reported very good health conditions. This indicates that while there are some negative health consequences associated with alcohol consumption, a significant proportion of male drinkers still maintain very good health.
   

   b) **Female:**
   
   * Non-consumers (No): 28.21% of females who abstain from alcohol reported bad health conditions, indicating a relatively high prevalence of health issues among non-drinkers.
   
   * Consumers (Yes): Among female drinkers, 14.24% reported bad health conditions, while 46.21% reported very good health conditions. This suggests that despite some negative health effects, a considerable proportion of female drinkers still enjoy good overall health.


4. **Age Group: 65 and over:**

   a) **Male:**
   
   * Non-consumers (No): 32.33% of non-drinking males reported bad health conditions, indicating a high prevalence of health issues among this group.
   
   * Consumers (Yes): Among male drinkers, 32.66% reported bad health conditions, while 48.57% reported very good health conditions. This suggests that while there are negative health consequences associated with alcohol consumption, a considerable proportion of male drinkers still maintain very good health.

   b) **Female:**
   
   * Non-consumers (No): 36.30% of females who abstain from alcohol reported bad health conditions, which is higher than the rate among non-drinking males.
   
   * Consumers (Yes): Among female drinkers, 26.46% reported bad health conditions, while 47.32% reported very good health conditions. This indicates that despite some negative health effects, a significant proportion of female drinkers still enjoy good overall health.


   **Conclusion:** 
   
* In the 15-24 age group, both male and female non-drinkers generally maintain good health. While some negative health effects are observed among drinkers, a considerable number of individuals, especially females, still report very good health conditions despite alcohol consumption.
   
* In the 25-44 age group, non-drinking males have a higher prevalence of health issues compared to non-drinking females. However, both male and female drinkers in this age range exhibit a similar pattern, with a portion facing negative health effects but a substantial number maintaining very good health conditions.
   
* In the 45-64 age group, both non-drinking males and females have a higher prevalence of health issues compared to younger age groups. However, among drinkers, a significant proportion still maintains very good health, especially among females.
   
   
* In the 65 and over age group, both non-drinking males and females exhibit a high prevalence of health issues. However, among drinkers, a considerable proportion still maintains very good health, suggesting that moderate alcohol consumption may not significantly compromise overall health in this age group.

Overall, the analysis shows that while alcohol consumption can lead to some negative health effects, a considerable proportion of individuals across different age groups still maintain good or very good health despite drinking. It's important to note that moderation and individual factors play a significant role in the overall impact of alcohol on health. These findings highlight the need for responsible alcohol consumption and personalized health considerations when assessing the relationship between alcohol and health outcomes.



### 15. In the last 12 months, how often have you consumed alcoholic beverages and have a private health insurance?

```{r, echo = FALSE, warning=FALSE,message=FALSE}

# Select the columns related to alcohol consumption, gender, age group, and private health insurance from the dataset and assign them to "s15"

s15 <- n1[c("q14", "q52", "ageclass", "q55")]


health_ins_al <- s15 %>%
  group_by(q14,q52,ageclass,q55) %>% # Group the dataframe by alcohol consumption, gender, age group, and private health insurance 
  drop_na() |>
  dplyr::summarize(count = n()) %>% # Calculate the count of individuals in each combination
  ungroup() %>%
  group_by(q14,q52,ageclass) %>%
  dplyr::mutate(perc = count*100/sum(count))  # Calculate the percentage of individuals in each combination


# Plot the results
ggplot(health_ins_al, aes(x = ageclass, y = perc, fill=q55)) +
  geom_bar(stat = "identity") +
  scale_fill_discrete(name = "Do you have private health insurance?") +
  labs(x = "Age", y = "Percentage")+ # Set the x-axis label to "Age" and y-axis label to "Percentage"
  ggtitle("Health Insurance for People consume alcohol")+
  guides(color = guide_legend(reverse = TRUE))+ # Reverse the order of the legend
  theme(axis.text.x = element_text(angle = 90,hjust=1))+ # Adjust the angle of x-axis labels for better readability
  facet_grid(~q14+q52,labeller = label_both) # Facet the plot by alcohol consumption and gender

```



The breakdown of the consumption of alcohol (q14), private health insurance (q55), by gender (q52), and age class (AGECLASS):


1. **Gender: Female, Age Class: 15-24 years**:

   * Among females aged 15-24 years, 2.50% have private health insurance, while 97.50% do not have private health insurance.
  
   * Regarding alcohol consumption, 66.67% of females in this age group consume alcohol, and 33.33% do not consume alcohol.


2. **Gender: Male, Age Class: 15-24 years**:

   * Among males aged 15-24 years, 3.45% have private health insurance, while 96.55% do not have private health insurance.
 
   * Regarding alcohol consumption, 91.24% of males in this age group consume alcohol, and 8.76% do not consume alcohol.


3. **Gender: Female, Age Class: 25-44 years**:
   
   * Among females aged 25-44 years, 18.54% have private health insurance, while 81.46% do not have private health insurance.
  
   * Regarding alcohol consumption, 59.24% of females in this age group consume alcohol, and 40.76% do not consume alcohol.


4. **Gender: Male, Age Class: 25-44 years**:

   * Among males aged 25-44 years, 12.93% have private health insurance, while 87.07% do not have private health insurance.
  
   * Regarding alcohol consumption, 92.15% of males in this age group consume alcohol, and 7.85% do not consume alcohol.


5. **Gender: Female, Age Class: 45-64 years**:
   
   * Among females aged 45-64 years, 21.17% have private health insurance, while 78.83% do not have private health insurance.
  
   * Regarding alcohol consumption, 88.39% of females in this age group consume alcohol, and 11.61% do not consume alcohol.


6. **Gender: Male, Age Class: 45-64 years**:

   * Among males aged 45-64 years, 15.44% have private health insurance, while 84.56% do not have private health insurance.
  
   * Regarding alcohol consumption, 88.39% of males in this age group consume alcohol, and 11.61% do not consume alcohol.


7. **Gender: Female, Age Class: 65 and over**:

   * Among females aged 65 and over, 14.07% have private health insurance, while 85.93% do not have private health insurance.
  
   * Regarding alcohol consumption, 81.28% of females in this age group consume alcohol, and 18.72% do not consume alcohol.


8. **Gender: Male, Age Class: 65 and over**:

   * Among males aged 65 and over, 11.88% have private health insurance, while 88.12% do not have private health insurance.
  
   * Regarding alcohol consumption, 81.28% of males in this age group consume alcohol, and 18.72% do not consume alcohol.



### 16. What is the relationship between the prevalence of consumption of alcohol among the surveyed individuals based on their age group and their status as the Chief Income Earner in their household?


```{r, echo = FALSE, warning=FALSE,message=FALSE}

# Select the columns related to alcohol consumption, age group, and chief income earner from the dataset and assign them to "s16"

s16 <- n1[c("q14", "ageclass", "q63b")]

income1 <- s16 %>%
  group_by(ageclass,q63b,q14) %>% # Group the dataframe by age group, chief income earner, and alcohol consumption
  drop_na() |>
  dplyr::summarize(count = n()) %>% # Calculate the count of individuals in each combination
  ungroup() %>%
  group_by(ageclass,q63b) %>%
  dplyr::mutate(perc = count*100/sum(count),q14=q14) # Calculate the percentage of individuals in each combination


ggplot(income1, aes(x = ageclass, y = perc, fill=q14)) + # Create a bar plot with age group on the x-axis, percentage on the y-axis, and fill color based on alcohol consumption
  geom_bar(stat = "identity") +
  scale_fill_discrete(name = "Do You consume alcohol") +
  labs(x = "Age", y = "Percentage")+
  ggtitle("Chief Income Earner")+
  guides(color = guide_legend(reverse = TRUE))+ # Reverse the order of the legend
  theme(axis.text.x = element_text(angle = 30,hjust=1))+ # Adjust the angle of x-axis labels for better readability
  facet_wrap(~q63b,labeller = label_both) # Facet the plot by chief income earner

```



Based on the breakdown of being the Chief Income Earner in the household (q63b) by age class (AGECLASS) and alcohol consumption (q14), let's provide a detailed explanation and conclusion:

1. **Age Class: 15-24 years**:

   * Among individuals aged 15-24 years, a significant majority (91.24%) of those who are the Chief Income Earner consume alcohol.
   
   * The count for Chief Income Earners in this age group who consume alcohol is 125, while those who do not consume alcohol have a count of 12.
   
   * Among those who are not the Chief Income Earner, there is a higher count of individuals who consume alcohol (356) compared to those who do not (129).


2. **Age Class: 25-44 years**:

   * In the age group of 25-44 years, the majority (92.15%) of those who are the Chief Income Earner consume alcohol.
   
   * The count for Chief Income Earners in this age group who consume alcohol is 1597, while those who do not consume alcohol have a count of 136.
   
   * Among those who are not the Chief Income Earner, there is a higher count of individuals who consume alcohol (688) compared to those who do not (88).


3. **Age Class: 45-64 years**:

   * Among individuals aged 45-64 years, the majority (88.39%) of those who are the Chief Income Earner consume alcohol.
   
   * The count for Chief Income Earners in this age group who consume alcohol is 1622, while those who do not consume alcohol have a count of 213.
   
   * Among those who are not the Chief Income Earner, there is a higher count of individuals who consume alcohol (568) compared to those who do not (100).


4. **Age Class: 65 and over**:

   * In the age group of 65 and over, the majority (81.28%) of those who are the Chief Income Earner consume alcohol.
   
   * The count for Chief Income Earners in this age group who consume alcohol is 1433, while those who do not consume alcohol have a count of 330.
   
   * Among those who are not the Chief Income Earner, there is a higher count of individuals who consume alcohol (229) compared to those who do not (73).

Overall, the data shows that across all age classes, a higher percentage of individuals who are the Chief Income Earner in their household consume alcohol compared to those who do not. This trend is consistent across different age groups.

It's important to note that alcohol consumption can have various implications on individuals' health, finances, and overall well-being. Further analysis and consideration of these factors would be necessary to draw more comprehensive conclusions.


### 17. How does folic acid consumption vary across different regions in terms of percentages?

```{r, echo = FALSE, warning=FALSE,message=FALSE}

# Select the columns related to region and folic acid supplement consumption from the dataset and assign them to the dataframe "s17"

s17 <- n1[c("lho","q120")]


# Calculate the percentage by region
suppl <- s17 %>%
  group_by(lho,q120) %>%
  dplyr::summarise(count = n()) |>
  drop_na() |>
  ungroup() %>%
  group_by(lho) %>%
  dplyr::mutate(perc = count/sum(count)*100) %>%  # Calculate the percentage of individuals in each combination
  dplyr::select(lho, q120, count)


# Filter out the records with "Dont know/refused" in the "q120" column
suppl <- suppl %>%
  filter(q120 != "Dont know/refused")


folic <- 
  suppl %>% 
  group_by(lho, q120) %>% 
  dplyr::summarise(count = sum(count)) %>%  # Summarize the count of individuals in each combination
  ungroup() %>% 
  group_by(lho) %>% 
  dplyr::summarise(perc = count*100/sum(count),
                   q120 = q120) %>%  # Calculate the percentage of individuals in each combination
  arrange(lho)


# Plot the results
ggplot(folic, aes(x = lho, y = perc, fill = q120)) +
  geom_bar(stat = "identity") +
  scale_fill_discrete(name = "Do you take folicacid suppliments?") +
  labs(x = "Age", y = "Percentage")+
  theme(axis.text.x = element_text(angle = 90,hjust=1))+ # Adjust the angle of x-axis labels for better readability
  ggtitle ( "Folic acid consumption by region")
```



1. Regional Variations: There are notable differences in folic acid consumption rates across different regions. Some regions have a higher percentage of individuals consuming folic acid supplements, while others have lower percentages. This suggests that there may be variations in awareness, accessibility, or cultural factors influencing folic acid consumption.

2. High Consumption Regions: Some regions stand out for their relatively high folic acid consumption rates. For example, regions like Tipperary South, Longford/Westmeath, and North Cork have higher percentages of individuals taking folic acid supplements. This indicates a positive trend in these regions and suggests the presence of effective health promotion efforts or prenatal care initiatives.

3. Low Consumption Regions: Conversely, there are regions with lower folic acid consumption rates. For instance, regions like Louth, Meath, and Dublin South East have relatively lower percentages of individuals taking folic acid supplements. This highlights areas where there might be a need for increased awareness campaigns and targeted interventions to promote folic acid supplementation during pregnancy.

4. Regional Disparities: The data reveals regional disparities in folic acid consumption. It is important to address these disparities to ensure equitable access to prenatal care and reduce the risk of birth defects. Targeted interventions and educational campaigns can be designed to raise awareness and encourage folic acid supplementation in regions with lower consumption rates.

In conclusion, the analysis of folic acid consumption by region provides valuable insights into the prevalence and regional variations of folic acid supplementation. This information can guide public health strategies and interventions aimed at improving folic acid awareness, accessibility, and uptake, ultimately contributing to better maternal and child health outcomes.



**calculating relative risk and an odds ratio (Folic acid consumption) for Meath compared to Galway**

* relative risk = 0.1052/0.0682 = 1.54

* odds for Meath = 0.1052/(1-0.1052) = 0.11

* odds for Galway = 0.0682/(1-0.0682) = 0.07

* odds ratio = 0.11/0.07 = 1.57


Based on the data, the relative risk of folic acid consumption in Meath compared to Galway is 1.54. This indicates that individuals in Meath have a 1.54 times higher risk of consuming folic acid supplements compared to individuals in Galway.

The odds for folic acid consumption in Meath are 0.11, meaning that the odds of individuals in Meath taking folic acid supplements are 0.11 times the odds of not taking them. In comparison, the odds for folic acid consumption in Galway are 0.07, indicating that the odds of individuals in Galway taking folic acid supplements are 0.07 times the odds of not taking them.

The odds ratio for Meath compared to Galway is 1.57. This means that individuals in Meath have 1.57 times higher odds of consuming folic acid supplements compared to individuals in Galway.

In conclusion, the calculations suggest that there is a higher prevalence of folic acid consumption in Meath compared to Galway. The relative risk, odds ratio, and odds values support the notion that individuals in Meath are more likely to consume folic acid supplements. These findings can guide public health initiatives and interventions to target regions with lower folic acid consumption, such as Galway, in order to improve awareness and accessibility to folic acid supplementation.





### 18. How do individuals rate their own health in general, and are there differences between genders and lhos?


```{r, echo = FALSE, warning=FALSE,message=FALSE}

s18 <- n1 %>% 
  dplyr::group_by(spq1, q52, lho) %>%  # Group the dataframe by self-perceived health (spq1), gender (q52), and local health office (lho)
  dplyr::summarise(count = n()) |>
  drop_na() |>
  ungroup() %>%
  group_by(spq1) %>%
  dplyr::mutate(perc = count/sum(count)*100) %>%
  dplyr::select(spq1, q52, lho, count) 


health <- 
  s18 %>% 
  group_by(spq1, q52, lho) %>%  # Group the dataframe by self-perceived health (spq1), gender (q52), and local health office (lho)
  dplyr::summarise(count = sum(count)) %>%  # Calculate the total count for each combination of spq1, q52, and lho
  ungroup() %>%
  group_by(lho, q52) %>%  # Regroup the dataframe by local health office (lho) and gender (q52)
  dplyr::summarise(spq1 = spq1, perc = count*100/sum(count)) %>%  # Calculate the percentage 
  arrange(lho)  # Arrange the dataframe in ascending order based on local health office (lho)


# Plot the results
ggplot(health, aes(x = q52, y = perc, fill = spq1)) +  # Set the x-axis as gender (q52), y-axis as percentage (perc), and fill color based on self-perceived health (spq1)
  geom_bar(stat = "identity") +  # Create a bar plot with actual values
  labs(x = "Gender", y = "Proportion", fill = "Health Status") +  # Set the labels for x-axis, y-axis, and fill legend
  ggtitle("Proportion of Individuals Rating Their Health by Gender in various Counties") +  # Set the title of the plot
  facet_wrap(~lho)  # Create separate panels for each local health office (lho) in the plot

```


Based on the breakdown of self-perceived health (spq1) by local health office (lho), gender (q52), and the corresponding percentages, the detailed explanation is as follows:

**Local Health Office: Carlow/Kilkenny**

 * Among males, 18.37% perceive their health as "Bad," 38.78% perceive it as "Good," and 42.86% perceive it as "Very Good."
 
 * Among females, 16.67% perceive their health as "Bad," 25.64% perceive it as "Good," and 57.69% perceive it as "Very Good."


**Local Health Office: Cavan/Monaghan**

 * Among males, 20% perceive their health as "Bad," 28.42% perceive it as "Good," and 51.58% perceive it as "Very Good."
 
 * Among females, 15.89% perceive their health as "Bad," 34.58% perceive it as "Good," and 49.53% perceive it as "Very Good."


**Local Health Office: Clare**

 * Among males, 26.44% perceive their health as "Bad," 49.43% perceive it as "Good," and 24.14% perceive it as "Very Good."
 
 * Among females, 17.53% perceive their health as "Bad," 45.36% perceive it as "Good," and 37.11% perceive it as "Very Good."


**Local Health Office: Cork**

 * Among males, 15.68% perceive their health as "Bad," 43.94% perceive it as "Good," and 40.38% perceive it as "Very Good."
 
 * Among females, 14.52% perceive their health as "Bad," 38.60% perceive it as "Good," and 46.88% perceive it as "Very Good."


**Local Health Office: Donegal**

 * Among males, 28.43% perceive their health as "Bad," 44.16% perceive it as "Good," and 27.41% perceive it as "Very Good."
 
 * Among females, 22.02% perceive their health as "Bad," 49.54% perceive it as "Good," and 28.44% perceive it as "Very Good."


**Local Health Office: Dublin**

 * Among males, 17.49% perceive their health as "Bad," 41.98% perceive it as "Good," and 40.52% perceive it as "Very Good."
 
 * Among females, 16.29% perceive their health as "Bad," 40.99% perceive it as "Good," and 42.72% perceive it as "Very Good."


**Local Health Office: Galway**

 * Among males, 14.98% perceive their health as "Bad," 32.60% perceive it as "Good," and 52.42% perceive it as "Very Good."
 
 * Among females, 9.92% perceive their health as "Bad," 39.26% perceive it as "Good," and 50.83% perceive it as "Very Good."


**Local Health Office: Kerry**

 * Among males, 18.84% perceive their health as "Bad," 50.72% perceive it as "Good," and 30.43% perceive it as "Very Good."
 
 * Among females, 18.07% perceive their health as "Bad," 33.73% perceive it as "Good," and 48.19% perceive it as "Very Good."


**Local Health Office: Kildare/West Wicklow**

 * Among males, 23.85% perceive their health as "Bad," 30.28% perceive it as "Good," and 45.87% perceive it as "Very Good."

 * Among females, 18.31% perceive their health as "Bad," 30.28% perceive it as "Good," and 51.41% perceive it as "Very Good."


**Local Health Office: Laois/Offaly**

 * Among males, 20.93% perceive their health as "Bad," 33.33% perceive it as "Good," and 45.74% perceive it as "Very Good."
 
 * Among females, 17.58% perceive their health as "Bad," 35.15% perceive it as "Good," and 47.27% perceive it as "Very Good."


**Local Health Office: Limerick**

 * Among males, 22.54% perceive their health as "Bad," 45.07% perceive it as "Good," and 32.39% perceive it as "Very Good."

 * Among females, 16.09% perceive their health as "Bad," 40.80% perceive it as "Good," and 43.10% perceive it as "Very Good."


**Local Health Office: Longford/Westmeath**

 * Among males, 13.82% perceive their health as "Bad," 35.53% perceive it as "Good," and 50.66% perceive it as "Very Good."
 
 * Among females, 18.59% perceive their health as "Bad," 38.46% perceive it as "Good," and 42.95% perceive it as "Very Good."


**Local Health Office: Louth**

 * Among males, 19.30% perceive their health as "Bad," 33.33% perceive it as "Good," and 47.37% perceive it as "Very Good."
 
 * Among females, 12.84% perceive their health as "Bad," 28.38% perceive it as "Good," and 58.78% perceive it as "Very Good."


**Local Health Office: Mayo**

 * Among males, 23.42% perceive their health as "Bad," 41.14% perceive it as "Good," and 35.44% perceive it as "Very Good."
 
 * Among females, 19.49% perceive their health as "Bad," 36.92% perceive it as "Good," and 43.59% perceive it as "Very Good."


**Local Health Office: Meath**

 * Among males, 20.00% perceive their health as "Bad," 32.63% perceive it as "Good," and 47.37% perceive it as "Very Good."
 
 * Among females, 9.21% perceive their health as "Bad," 30.26% perceive it as "Good," and 60.53% perceive it as "Very Good."


**Local Health Office: Roscommon**

 * Among males, 20.75% perceive their health as "Bad," 37.74% perceive it as "Good," and 41.51% perceive it as "Very Good."
 
 * Among females, 20.72% perceive their health as "Bad," 49.55% perceive it as "Good," and 29.73% perceive it as "Very Good."


**Local Health Office: Sligo/Leitrim/West Cavan**

 * Among males, 20.37% perceive their health as "Bad," 39.81% perceive it as "Good," and 39.81% perceive it as "Very Good."
 
 * Among females, 17.36% perceive their health as "Bad," 45.45% perceive it as "Good," and 37.19% perceive it as "Very Good."


**Local Health Office: Tipperary**

 * Among males, 23.97% perceive their health as "Bad," 41.78% perceive it as "Good," and 34.25% perceive it as "Very Good."
 
 * Among females, 13.92% perceive their health as "Bad," 44.94% perceive it as "Good," and 41.14% perceive it as "Very Good."


**Local Health Office: Waterford**

 * Among males, 15.38% perceive their health as "Bad," 38.46% perceive it as "Good," and 46.15% perceive it as "Very Good."
 
 * Among females, 15.76% perceive their health as "Bad," 31.52% perceive it as "Good," and 52.73% perceive it as "Very Good."


 **Local Health Office: Wexford**

 * Among males, 18.60% perceive their health as "Bad," 37.21% perceive it as "Good," and 44.19% perceive it as "Very Good."

 * Among females, 15.83% perceive their health as "Bad," 33.81% perceive it as "Good," and 50.36% perceive it as "Very Good."


**Local Health Office: Wicklow**

 * Among males, 21.30% perceive their health as "Bad," 30.56% perceive it as "Good," and 48.15% perceive it as "Very Good."

 * Among females, 15.67% perceive their health as "Bad," 23.13% perceive it as "Good," and 61.19% perceive it as "Very Good."


Overall, the analysis reveals variations in self-perceived health across different Local Health Offices. While the majority of individuals perceive their health as "Very Good" across most LHOs, there are variations in the percentages of individuals perceiving their health as "Good" or "Bad" across different gender groups and regions. These findings provide valuable insights into the distribution of self-perceived health, highlighting potential variations in health outcomes and the importance of considering regional and gender differences when addressing public health concerns.




### Models - Smoking

```{r,echo = FALSE, warning=FALSE,message=FALSE}

# Select relevant variables
example_dat <- n1 %>% dplyr::select(q6, ageclass, q52,key1,lho,q120)

# Drop rows with missing values
example_dat <- example_dat %>% drop_na()

# Convert variables to appropriate data types
example_dat <- example_dat %>% mutate(q6_binary = as.factor(q6),
                                      ageclass = as.factor(as.character(ageclass)),
                                      q52 = as.factor(as.character(q52)),
                                      key1 = as.factor(as.character(key1)),
                                      lho = as.factor(as.character(lho)),
                                      q120 = as.factor(as.character(q120)))

# Create a training and testing dataset
set.seed(123)
trainIndex <- createDataPartition(example_dat$q6_binary, p = 0.8, list = FALSE)
train_data <- example_dat[trainIndex, ]
test_data <- example_dat[-trainIndex, ]

# Fit logistic regression model
logistic_mod <- glm(q6_binary ~ ageclass + q52+key1+lho+q120, data = train_data, family = "binomial")

# Fit Naive Bayes model
naive_bayes <- naive_bayes(q6_binary ~ ageclass + q52+key1+lho+q120, data = train_data)

```




```{r,echo = FALSE, warning=FALSE,message=FALSE}

# Generate predicted probabilities
predicted_probs <- predict(logistic_mod, newdata = train_data, type = "response")

# Create a data frame with age class and predicted probabilities
plot_data <- data.frame(ageclass = train_data$ageclass, predicted_prob = predicted_probs*100)

# Sort the data frame by age class
plot_data <- plot_data[order(plot_data$ageclass), ]

# Plot the predicted probabilities
plot(plot_data$ageclass, plot_data$predicted_prob, type = "l", 
     xlab = "Age Class", ylab = "Probability of Yes (in %)", 
     main = "Logistic Regression: Predicted Probabilities")

# Add points for observed data
points(train_data$ageclass, train_data$q6_binary, pch = 16, col = "blue")

# Add a legend
legend("topright", legend = c("Observed Data"), 
       pch = c(16, NA), col = c("blue", "black"), bty = "n")


```


```{r,echo = FALSE, warning=FALSE,message=FALSE}
#pred <- predict(logistic_mod, newdata = test_data, type = "response")

#range(pred)
```



#### Finding the Optimal Threshold for Logistic Regression using ROC Curve and Youden's J Statistic

```{r,echo = FALSE, warning=FALSE,message=FALSE}

# Get the predicted probabilities from the logistic regression model
predicted_probabilities <- predict(logistic_mod, newdata = test_data, type = "response")

# Create an ROC curve object
roc_curve <- roc(test_data$q6_binary, predicted_probabilities)

# Print the AUC Value
print(roc_curve)

# Find the optimal threshold that maximizes the Youden Index (J) or Youden's J statistic
optimal_threshold <- coords(roc_curve, "best", ret = "threshold")

# Print the optimal threshold
print(paste("Optimal Threshold:", round(optimal_threshold, 2)))

```




#### Logistic Regression - Accuracy

```{r,echo = FALSE, warning=FALSE,message=FALSE}

# Evaluate the logistic regression model on the test dataset using a threshold of 0.25 for classification.
# Predicted_classes_logistic variable stores the predicted classes based on the logistic regression model.

predicted_classes_logistic <- ifelse(predict(logistic_mod, newdata = test_data, type = "response") > 0.2, "Yes", "No")

# Convert the original test_data$q6_binary variable to a factor with the same levels as predicted_classes_logistic.
# This step ensures that both the observed and predicted classes have the same factor levels for comparison.

test_data$q6_binary <- factor(test_data$q6_binary, levels = c("Yes", "No"))

# Convert the predicted_classes_logistic variable to a factor with the same levels as test_data$q6_binary.
# This is necessary for creating the confusion matrix to compare the predicted and observed classes.

predicted_classes_logistic <- factor(predicted_classes_logistic, levels = c("Yes", "No"))

# Create the confusion matrix using the predicted classes and the actual classes.
# The confusion matrix helps assess the model's performance in classifying instances into true positive, true negative, false positive, and false negative.

confusion_matrix <- confusionMatrix(predicted_classes_logistic, test_data$q6_binary)

# Print the confusion matrix, which includes the counts of true positives, true negatives, false positives, and false negatives.
print(confusion_matrix)

# Calculate and print the model's accuracy, precision, and F1-Score from the confusion matrix.

accuracy <- round(confusion_matrix$overall["Accuracy"], digits = 4)
precision <- confusion_matrix$byClass["Precision"]
f1_score <- confusion_matrix$byClass["F1"]

print(paste("Accuracy:", accuracy * 100))
print(paste("Precision:", round(precision, 4) * 100))
print(paste("F1-Score:", round(f1_score, 4) * 100))

```


```{r,echo = FALSE, warning=FALSE,message=FALSE}

# Evaluate the goodness-of-fit of the logistic regression model using the Hosmer-Lemeshow test with 10 bins.
# The performance_hosmer function assesses how well the model's predicted probabilities match the observed outcomes.

performance_hosmer(logistic_mod, n_bins = 10)

```


```{r,echo = FALSE, warning=FALSE,message=FALSE}
# Perform an analysis of deviance (ANOVA) using the Chi-squared test on the logistic regression model.

anova(logistic_mod, test = "Chisq")

```



```{r,echo = FALSE, warning=FALSE,message=FALSE}

# Calculate AIC (Akaike Information Criterion) for the logistic regression model.

aic_value <- AIC(logistic_mod)

# Calculate BIC (Bayesian Information Criterion) for the logistic regression model.

bic_value <- BIC(logistic_mod)


# Print the AIC and BIC values rounded to two decimal places.

print(paste("AIC Value:", round(aic_value, 2)))

print(paste("BIC Value:", round(bic_value, 2)))

```




#### Naive bayes - Accuracy
```{r,echo = FALSE, warning=FALSE,message=FALSE}

# Predict the probabilities of each class using the Naive Bayes model
predicted_probs_nb <- predict(naive_bayes, newdata = test_data, type = "prob")


# Convert the probabilities to class predictions using the threshold
predicted_classes_nb_threshold <- ifelse(predicted_probs_nb[, "Yes"] > 0.2, "Yes", "No")

# Convert the predicted classes to factor with the same levels as the test data
predicted_classes_nb_threshold <- factor(predicted_classes_nb_threshold, levels = levels(test_data$q6_binary))


# Create the confusion matrix with threshold
confusion_matrix_nb_threshold <- confusionMatrix(predicted_classes_nb_threshold, test_data$q6_binary)

# Print the confusion matrix, which includes the counts of true positives, true negatives, false positives, and false negatives.
print(confusion_matrix_nb_threshold)


# Calculate and print the model's accuracy, precision, and F1-Score from the confusion matrix.

accuracy_nb_threshold <- round(confusion_matrix_nb_threshold$overall["Accuracy"], digits = 4)

precision <- confusion_matrix_nb_threshold$byClass["Precision"]

f1_score <- confusion_matrix_nb_threshold$byClass["F1"]


print(paste("Accuracy:", accuracy_nb_threshold * 100))

print(paste("Precision:", round(precision, 4) * 100))

print(paste("F1-Score:", round(f1_score, 4) * 100))

```




### Models - Alcohol

```{r,echo = FALSE, warning=FALSE,message=FALSE}

# Prepare the dataset by selecting specific columns for analysis
example_dat1 <- n1 %>% dplyr::select(q14,ageclass,q52,key1,lho,q330_1,q330_2)

# Drop rows with missing values
example_dat1 <- example_dat1 %>% drop_na()

# Convert variables to appropriate data types for modeling
example_dat1 <- example_dat1 %>% mutate(q14_binary = as.factor(q14),
                                      ageclass = as.factor(as.character(ageclass)),
                                      q52 = as.factor(as.character(q52)),
                                      key1 = as.factor(as.character(key1)),
                                      lho = as.factor(as.character(lho)),
                                      q330_1 = as.factor(as.character(q330_1)),
                                      q330_2 = as.factor(as.character(q330_2)))



# Create a training and testing dataset using 80-20 split

set.seed(123)
trainIndex1 <- createDataPartition(example_dat1$q14_binary, p = 0.8, list = FALSE)
train_data1 <- example_dat1[trainIndex1, ]
test_data1 <- example_dat1[-trainIndex1, ]


# Fit the logistic regression model with specified predictors
logistic_mod1 <- glm(q14_binary ~ ageclass + q52 + key1 + lho + q330_1 + q330_2, data = train_data1, family = "binomial")

# Fit the Naive Bayes model with the same predictors as logistic regression
naive_bayes1 <- naive_bayes(q14_binary ~ ageclass + q52 + key1 + lho + q330_1 + q330_2, data = train_data1)

```


#### Finding the Optimal Threshold for Logistic Regression using ROC Curve and Youden's J Statistic

```{r,echo = FALSE, warning=FALSE,message=FALSE}

# Get the predicted probabilities from the logistic regression model
predicted_probabilities1 <- predict(logistic_mod1, newdata = test_data1, type = "response")

# Create an ROC curve object
roc_curve1 <- roc(test_data1$q14_binary, predicted_probabilities1)

# Print the AUC Value
print(roc_curve1)

# Find the optimal threshold that maximizes the Youden Index (J) or Youden's J statistic
optimal_threshold1 <- coords(roc_curve1, "best", ret = "threshold")

# Print the optimal threshold
print(paste("Optimal Threshold:", round(optimal_threshold1, 2)))
```


#### Logistic Regression - Accuracy
```{r,echo = FALSE, warning=FALSE,message=FALSE}

# Evaluate the model on the test dataset
predicted_classeslog1 <- ifelse(predict(logistic_mod1, newdata = test_data1, type = "response") > 0.82, "Yes", "No")

# Convert test_data$q6_binary to a factor with the same levels as predicted_classes
test_data1$q14_binary <- factor(test_data1$q14_binary, levels = c("Yes", "No"))

# Convert predicted_classes to a factor with the same levels as test_data$q6_binary
predicted_classeslog1 <- factor(predicted_classeslog1, levels = c("Yes", "No"))

# Create the confusion matrix
confusion_matrix1 <- confusionMatrix(predicted_classeslog1, test_data1$q14_binary)


# Print the model summary
#summary(logistic_mod1)

# Print the confusion matrix, which includes the counts of true positives, true negatives, false positives, and false negatives.
print(confusion_matrix1)


# Calculate and print the model's accuracy, precision, and F1-Score from the confusion matrix.

accuracy1 <- round(confusion_matrix1$overall["Accuracy"], digits = 4)

precision1 <- confusion_matrix1$byClass["Precision"]

f1_score1<- confusion_matrix1$byClass["F1"]


print(paste("Accuracy:", accuracy1 * 100))
print(paste("Precision:", round(precision1, 4) * 100))
print(paste("F1-Score:", round(f1_score1, 4) * 100))

```


```{r,echo = FALSE, warning=FALSE,message=FALSE}
# Evaluate the goodness-of-fit of the logistic regression model using the Hosmer-Lemeshow test with 10 bins.

performance_hosmer(logistic_mod1, n_bins = 10)

```

```{r,echo = FALSE, warning=FALSE,message=FALSE}

# Perform an analysis of deviance (ANOVA) using the Chi-squared test on the logistic regression model.

anova(logistic_mod1, test="Chisq")
```


```{r,echo = FALSE, warning=FALSE,message=FALSE}

# Calculate AIC (Akaike Information Criterion) for the logistic regression model.
aic_value1 <- AIC(logistic_mod1)


# Calculate BIC (Bayesian Information Criterion) for the logistic regression model.
bic_value1 <- BIC(logistic_mod1)


# Print the AIC and BIC values rounded to two decimal places.
print(paste("AIC Value:", round(aic_value1, 2)))
print(paste("BIC Value:", round(bic_value1, 2)))

```



#### Naive bayes - Accuracy


```{r,echo = FALSE, warning=FALSE,message=FALSE}
# Predict the class probabilities using the Naive Bayes model
predicted_probs_nb1 <- predict(naive_bayes1, newdata = test_data1, type = "prob")


# Create a vector to store the predicted classes based on the threshold
predicted_classes_nb1_threshold <- ifelse(predicted_probs_nb1[, "Yes"] > 0.82, "Yes", "No")

# Ensure both predicted classes and test_data1$q14_binary have the same levels
predicted_classes_nb1_threshold <- factor(predicted_classes_nb1_threshold, levels = levels(test_data1$q14_binary))

# Create the confusion matrix with threshold
confusion_matrix_nb1_threshold <- confusionMatrix(predicted_classes_nb1_threshold, test_data1$q14_binary)


# Print confusion matrix with threshold
print(confusion_matrix_nb1_threshold)


# Calculate and print the model's accuracy, precision, and F1-Score from the confusion matrix.
accuracy_nb1_threshold <- round(confusion_matrix_nb1_threshold$overall["Accuracy"], digits = 4)
precision <- confusion_matrix_nb1_threshold$byClass["Precision"]
f1_score <- confusion_matrix_nb1_threshold$byClass["F1"]


print(paste("Accuracy:", accuracy_nb1_threshold * 100))
print(paste("Precision:", round(precision, 4) * 100))
print(paste("F1-Score:", round(f1_score, 4) * 100))

```

